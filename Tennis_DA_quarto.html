<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2013 Grand Slams Tennis Data Analysis and Modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Tennis_DA_quarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="Tennis_DA_quarto_files/libs/quarto-html/quarto.js"></script>
<script src="Tennis_DA_quarto_files/libs/quarto-html/popper.min.js"></script>
<script src="Tennis_DA_quarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Tennis_DA_quarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="Tennis_DA_quarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Tennis_DA_quarto_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Tennis_DA_quarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Tennis_DA_quarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Tennis_DA_quarto_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table Of Contents</h2>
   
  <ul>
  <li><a href="#brief-statement-of-the-aim-of-the-project" id="toc-brief-statement-of-the-aim-of-the-project" class="nav-link active" data-scroll-target="#brief-statement-of-the-aim-of-the-project">1. Brief Statement of the aim of the project</a></li>
  <li><a href="#source-of-the-data-variables-dependent-variable" id="toc-source-of-the-data-variables-dependent-variable" class="nav-link" data-scroll-target="#source-of-the-data-variables-dependent-variable">2. Source of the data variables, dependent variable</a></li>
  <li><a href="#data-cleaning-and-tidying" id="toc-data-cleaning-and-tidying" class="nav-link" data-scroll-target="#data-cleaning-and-tidying">3. Data Cleaning and Tidying</a></li>
  <li><a href="#explanatory-data-analysiseda-and-confirmatory-data-analysiscda" id="toc-explanatory-data-analysiseda-and-confirmatory-data-analysiscda" class="nav-link" data-scroll-target="#explanatory-data-analysiseda-and-confirmatory-data-analysiscda">4. Explanatory Data Analysis(EDA) and Confirmatory Data Analysis(CDA)</a>
  <ul class="collapse">
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics">Summary Statistics</a></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions">Research Questions</a></li>
  </ul></li>
  <li><a href="#missing-observation-cleaning-imputation-and-data-manipulation" id="toc-missing-observation-cleaning-imputation-and-data-manipulation" class="nav-link" data-scroll-target="#missing-observation-cleaning-imputation-and-data-manipulation">5. Missing Observation Cleaning, Imputation and Data Manipulation</a></li>
  <li><a href="#classification-statistical-modelling" id="toc-classification-statistical-modelling" class="nav-link" data-scroll-target="#classification-statistical-modelling">Classification Statistical Modelling</a>
  <ul class="collapse">
  <li><a href="#train-test-data-set-preparation" id="toc-train-test-data-set-preparation" class="nav-link" data-scroll-target="#train-test-data-set-preparation">Train-Test Data Set Preparation</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a></li>
  <li><a href="#support-vector-machine-modeling" id="toc-support-vector-machine-modeling" class="nav-link" data-scroll-target="#support-vector-machine-modeling">Support Vector Machine Modeling</a></li>
  <li><a href="#random-forest-model" id="toc-random-forest-model" class="nav-link" data-scroll-target="#random-forest-model">Random Forest Model</a></li>
  <li><a href="#artificial-neural-network-model" id="toc-artificial-neural-network-model" class="nav-link" data-scroll-target="#artificial-neural-network-model">Artificial Neural Network Model</a></li>
  <li><a href="#model-comparison-table" id="toc-model-comparison-table" class="nav-link" data-scroll-target="#model-comparison-table">Model Comparison Table</a></li>
  </ul></li>
  <li><a href="#regression-modelling-for-tpw" id="toc-regression-modelling-for-tpw" class="nav-link" data-scroll-target="#regression-modelling-for-tpw">Regression Modelling for TPW</a>
  <ul class="collapse">
  <li><a href="#train-test-data-set-preparation-1" id="toc-train-test-data-set-preparation-1" class="nav-link" data-scroll-target="#train-test-data-set-preparation-1">Train-Test Data Set Preparation</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#lasso-and-ridge-regression" id="toc-lasso-and-ridge-regression" class="nav-link" data-scroll-target="#lasso-and-ridge-regression">Lasso and Ridge Regression</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">2013 Grand Slams Tennis Data Analysis and Modelling</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="brief-statement-of-the-aim-of-the-project" class="level2">
<h2 class="anchored" data-anchor-id="brief-statement-of-the-aim-of-the-project">1. Brief Statement of the aim of the project</h2>
<p>In this project, data is 4 different tennis singles 2013 grand slams match statistics. In the data, there are different statistics about match like foul, number of firs serve win, and others that will be explained in the next part. Aim of the project is predict the result of the tennis match by using different match statistics. Another aim is to find most effective match statistics for the win, and how is change for different tournament and gender. To reach this aim, firstly, data will be cleaned and tidied for the EDA and CDA. Then, explanatory data analysis will be done to see how data distributed and to interpret variables effectively. After EDA, missing values will be handled and data manipulation and feature engineering will be done if it is necessary. After data preparation is done, Confirmatory data analysis will be done by considering EDA. Finally, for statistical modeling to predict match result cross-validation techniques will be used. Finally, statistical modeling will be performed and performance of statistical modeling will be investigated.</p>
</section>
<section id="source-of-the-data-variables-dependent-variable" class="level2">
<h2 class="anchored" data-anchor-id="source-of-the-data-variables-dependent-variable">2. Source of the data variables, dependent variable</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>AusOpenMen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/boltainn/Tennis_DA_project/main/AusOpen-men-2013.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>AusOpenWoMen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/boltainn/Tennis_DA_project/main/AusOpen-women-2013.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>FrenchOpenMen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/boltainn/Tennis_DA_project/main/FrenchOpen-men-2013.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>FrenchOpenWoMen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/boltainn/Tennis_DA_project/main/FrenchOpen-women-2013.csv"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>USOpenMen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/boltainn/Tennis_DA_project/main/USOpen-men-2013.csv"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>USOpenWoMen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/boltainn/Tennis_DA_project/main/USOpen-women-2013.csv"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>WimbledonMen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/boltainn/Tennis_DA_project/main/Wimbledon-men-2013.csv"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>WimbledonWoMen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/boltainn/Tennis_DA_project/main/Wimbledon-women-2013.csv"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">##Combine all data and create new variables as "tournament" and "gender"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>list_df <span class="ot">&lt;-</span> <span class="fu">list</span>(AusOpenMen,AusOpenWoMen,FrenchOpenMen,FrenchOpenWoMen,USOpenMen,USOpenWoMen,WimbledonMen,WimbledonWoMen)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>tournament_names<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'AusOpen'</span>,<span class="st">'AusOpen'</span>, <span class="st">'FrenchOpen'</span>, <span class="st">'FrenchOpen'</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'USopen'</span>, <span class="st">'USopen'</span>, <span class="st">'Wimbledon'</span>, <span class="st">'Wimbledon'</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>gender_name<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'M'</span>,<span class="st">'F'</span>,<span class="st">'M'</span>,<span class="st">'F'</span>,<span class="st">'M'</span>,<span class="st">'F'</span>,<span class="st">'M'</span>,<span class="st">'F'</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding two new variable</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>){</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  tournament<span class="ot">=</span><span class="fu">rep</span>(tournament_names[i],<span class="fu">dim</span>(list_df[[i]])[<span class="dv">1</span>])</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  gender<span class="ot">=</span><span class="fu">rep</span>(gender_name[i], <span class="fu">dim</span>(list_df[[i]])[<span class="dv">1</span>])</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  list_df[[i]]<span class="sc">$</span>tournament<span class="ot">=</span>tournament</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  list_df[[i]]<span class="sc">$</span>gender<span class="ot">=</span>gender</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="do">##Variable name fixing</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">names</span>(list_df[[<span class="dv">3</span>]])</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>){</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(list_df[[i]]) <span class="ot">=</span> col_names</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="do">##Create combined data</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> <span class="fu">rbind</span>(list_df[[<span class="dv">1</span>]],list_df[[<span class="dv">2</span>]],list_df[[<span class="dv">3</span>]],list_df[[<span class="dv">4</span>]],list_df[[<span class="dv">5</span>]],list_df[[<span class="dv">6</span>]],</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                    list_df[[<span class="dv">7</span>]],list_df[[<span class="dv">8</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Source of the data is <a href="https://archive.ics.uci.edu/dataset/300/tennis+major+tournament+match+statistics">UC Irvine Machine Learning Repository</a>. In the source of the data, there is 8 different csv file. Each one represent different tournament from 2013 (Aus Open-Men,AusOpen-Women, USOpen-men,…). Data has 4 different tournament group by gender, so we have 8 different csv file data. All of the 8 csv data has same 42 variables, so all of them are combined to 1 csv file and 2 variable added as tournament and gender. At the end, data has 44 variable. Dependent variable is ‘Result’. Our data have 943 match observations.</p>
<table class="table">
<caption>Variable Name and Definition</caption>
<colgroup>
<col style="width: 36%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th>Name of Variable</th>
<th>Definition of Variable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Player 1</td>
<td>Name of Player 1 (Nominal)</td>
</tr>
<tr class="even">
<td>Player 2</td>
<td>Name of Player 2 (Nominal)</td>
</tr>
<tr class="odd">
<td>Round</td>
<td>Round of the tourneament (Nominal Ordinal) (1: 1st elimination round, 7: Final of the tournament )</td>
</tr>
<tr class="even">
<td>Result</td>
<td>Result of the match (0/1) - Referenced on Player 1 is Result = 1 (Nominal)</td>
</tr>
<tr class="odd">
<td>FSP.1 and .2</td>
<td>First Serve Percentage for player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>FSW.1 and .2</td>
<td>First Serve Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>SSP.1 and .2</td>
<td>Second Serve Percentage for player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>SSW.1 and .2</td>
<td>Second Serve Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>ACE.1 and .2</td>
<td>Aces won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>DBF.1 and .2</td>
<td>Double Faults committed by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>WNR.1 and .2</td>
<td>Winners earned by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>UFE.1 and .2</td>
<td>Unforced Errors committed by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>BPC.1 and .2</td>
<td>Break Points Created by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>BPW.1 and .2</td>
<td>Break Points Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>NPA.1 and .2</td>
<td>Net Points Attempted by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>NPW.1 and .2</td>
<td>Net Points Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>TPW.1 and .2</td>
<td>Total Points Won by player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>ST1.1 and .2</td>
<td>Set 1 result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>ST2.1 and .2</td>
<td>Set 2 Result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>ST3.1 and .2</td>
<td>Set 3 Result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>ST4.1 and .2</td>
<td>Set 4 Result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>ST5.1 and .2</td>
<td>Set 5 Result for Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="odd">
<td>FNL.1 and .2</td>
<td>Final Number of Games Won by Player 1 (if .2, player 2) (Integer)</td>
</tr>
<tr class="even">
<td>tournament</td>
<td>Tournament name</td>
</tr>
<tr class="odd">
<td>gender</td>
<td>Tournament gender</td>
</tr>
</tbody>
</table>
</section>
<section id="data-cleaning-and-tidying" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-tidying">3. Data Cleaning and Tidying</h2>
<p>Check variables and data types:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(GrandSlam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   943 obs. of  44 variables:
 $ Player1   : chr  "Lukas Lacko" "Leonardo Mayer" "Marcos Baghdatis" "Dmitry Tursunov" ...
 $ Player2   : chr  "Novak Djokovic" "Albert Montanes" "Denis Istomin" "Michael Russell" ...
 $ Round     : int  1 1 1 1 1 1 1 1 1 1 ...
 $ Result    : int  0 1 0 1 0 0 0 1 0 1 ...
 $ FNL.1     : int  0 3 0 3 1 1 2 2 0 3 ...
 $ FNL.2     : int  3 0 3 0 3 3 3 0 3 2 ...
 $ FSP.1     : int  61 61 52 53 76 65 68 47 64 77 ...
 $ FSW.1     : int  35 31 53 39 63 51 73 18 26 76 ...
 $ SSP.1     : int  39 39 48 47 24 35 32 53 36 23 ...
 $ SSW.1     : int  18 13 20 24 12 22 24 15 12 11 ...
 $ ACE.1     : int  5 13 8 8 0 9 5 3 3 6 ...
 $ DBF.1     : int  1 1 4 6 4 3 3 4 NA 4 ...
 $ WNR.1     : int  17 13 37 8 16 35 41 21 20 6 ...
 $ UFE.1     : int  29 1 50 6 35 41 50 31 39 4 ...
 $ BPC.1     : int  1 7 1 6 3 2 9 6 3 7 ...
 $ BPW.1     : int  3 14 9 9 12 7 17 20 7 24 ...
 $ NPA.1     : int  8 NA 16 NA 9 6 14 6 5 NA ...
 $ NPW.1     : int  11 NA 23 NA 13 12 30 9 14 NA ...
 $ TPW.1     : int  70 80 106 104 128 108 173 78 67 162 ...
 $ ST1.1     : int  3 6 4 6 6 3 6 6 5 3 ...
 $ ST2.1     : int  6 6 5 6 4 2 6 6 4 6 ...
 $ ST3.1     : int  1 6 4 6 6 6 7 NA 1 3 ...
 $ ST4.1     : int  NA NA NA NA 2 6 3 NA NA 6 ...
 $ ST5.1     : int  NA NA NA NA NA NA 3 NA NA 6 ...
 $ FSP.2     : num  68 60 77 50 53 63 60 54 67 60 ...
 $ FSW.2     : int  45 23 57 24 59 60 66 26 42 68 ...
 $ SSP.2     : int  32 40 23 50 47 37 40 46 33 40 ...
 $ SSW.2     : int  17 9 15 19 32 22 34 13 14 25 ...
 $ ACE.2     : int  10 1 9 1 17 24 2 0 12 8 ...
 $ DBF.2     : int  0 4 1 8 11 4 6 11 NA 12 ...
 $ WNR.2     : int  40 1 41 1 59 47 57 11 32 8 ...
 $ UFE.2     : int  30 4 41 8 79 45 72 46 20 12 ...
 $ BPC.2     : int  4 0 4 1 3 4 10 2 7 6 ...
 $ BPW.2     : int  8 0 13 7 5 7 17 6 10 14 ...
 $ NPA.2     : int  8 NA 12 NA 16 14 25 8 8 NA ...
 $ NPW.2     : int  9 NA 16 NA 28 17 36 12 11 NA ...
 $ TPW.2     : int  101 42 126 79 127 122 173 61 94 141 ...
 $ ST1.2     : int  6 1 6 2 1 6 3 3 7 6 ...
 $ ST2.2     : int  7 3 7 2 6 6 7 2 6 3 ...
 $ ST3.2     : int  6 1 6 3 7 3 6 NA 6 6 ...
 $ ST4.2     : int  NA NA NA NA 6 7 6 NA NA 3 ...
 $ ST5.2     : int  NA NA NA NA NA NA 6 NA NA 4 ...
 $ tournament: chr  "AusOpen" "AusOpen" "AusOpen" "AusOpen" ...
 $ gender    : chr  "M" "M" "M" "M" ...</code></pre>
</div>
</div>
<p>Character values, “Round” and “Result” should be a factor. And name of the variables should be all upper or lower letter. So, all names of variables changed to upper letter.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Change all varaiable names to upper letter</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(GrandSlam) <span class="ot">&lt;-</span> <span class="fu">toupper</span>(<span class="fu">colnames</span>(GrandSlam))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before change character values, “Round” and “Result” to factor let’s check head and tail of the data set.</p>
<p>Head and tail of the data:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(GrandSlam), <span class="at">label =</span> <span class="st">"Head of the data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">PLAYER1</th>
<th style="text-align: left;">PLAYER2</th>
<th style="text-align: right;">ROUND</th>
<th style="text-align: right;">RESULT</th>
<th style="text-align: right;">FNL.1</th>
<th style="text-align: right;">FNL.2</th>
<th style="text-align: right;">FSP.1</th>
<th style="text-align: right;">FSW.1</th>
<th style="text-align: right;">SSP.1</th>
<th style="text-align: right;">SSW.1</th>
<th style="text-align: right;">ACE.1</th>
<th style="text-align: right;">DBF.1</th>
<th style="text-align: right;">WNR.1</th>
<th style="text-align: right;">UFE.1</th>
<th style="text-align: right;">BPC.1</th>
<th style="text-align: right;">BPW.1</th>
<th style="text-align: right;">NPA.1</th>
<th style="text-align: right;">NPW.1</th>
<th style="text-align: right;">TPW.1</th>
<th style="text-align: right;">ST1.1</th>
<th style="text-align: right;">ST2.1</th>
<th style="text-align: right;">ST3.1</th>
<th style="text-align: right;">ST4.1</th>
<th style="text-align: right;">ST5.1</th>
<th style="text-align: right;">FSP.2</th>
<th style="text-align: right;">FSW.2</th>
<th style="text-align: right;">SSP.2</th>
<th style="text-align: right;">SSW.2</th>
<th style="text-align: right;">ACE.2</th>
<th style="text-align: right;">DBF.2</th>
<th style="text-align: right;">WNR.2</th>
<th style="text-align: right;">UFE.2</th>
<th style="text-align: right;">BPC.2</th>
<th style="text-align: right;">BPW.2</th>
<th style="text-align: right;">NPA.2</th>
<th style="text-align: right;">NPW.2</th>
<th style="text-align: right;">TPW.2</th>
<th style="text-align: right;">ST1.2</th>
<th style="text-align: right;">ST2.2</th>
<th style="text-align: right;">ST3.2</th>
<th style="text-align: right;">ST4.2</th>
<th style="text-align: right;">ST5.2</th>
<th style="text-align: left;">TOURNAMENT</th>
<th style="text-align: left;">GENDER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lukas Lacko</td>
<td style="text-align: left;">Novak Djokovic</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leonardo Mayer</td>
<td style="text-align: left;">Albert Montanes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marcos Baghdatis</td>
<td style="text-align: left;">Denis Istomin</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dmitry Tursunov</td>
<td style="text-align: left;">Michael Russell</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Juan Monaco</td>
<td style="text-align: left;">Ernests Gulbis</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">Santiago Giraldo</td>
<td style="text-align: left;">Sam Querrey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tail</span>(GrandSlam),<span class="at">label =</span> <span class="st">"Tail of the data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">PLAYER1</th>
<th style="text-align: left;">PLAYER2</th>
<th style="text-align: right;">ROUND</th>
<th style="text-align: right;">RESULT</th>
<th style="text-align: right;">FNL.1</th>
<th style="text-align: right;">FNL.2</th>
<th style="text-align: right;">FSP.1</th>
<th style="text-align: right;">FSW.1</th>
<th style="text-align: right;">SSP.1</th>
<th style="text-align: right;">SSW.1</th>
<th style="text-align: right;">ACE.1</th>
<th style="text-align: right;">DBF.1</th>
<th style="text-align: right;">WNR.1</th>
<th style="text-align: right;">UFE.1</th>
<th style="text-align: right;">BPC.1</th>
<th style="text-align: right;">BPW.1</th>
<th style="text-align: right;">NPA.1</th>
<th style="text-align: right;">NPW.1</th>
<th style="text-align: right;">TPW.1</th>
<th style="text-align: right;">ST1.1</th>
<th style="text-align: right;">ST2.1</th>
<th style="text-align: right;">ST3.1</th>
<th style="text-align: right;">ST4.1</th>
<th style="text-align: right;">ST5.1</th>
<th style="text-align: right;">FSP.2</th>
<th style="text-align: right;">FSW.2</th>
<th style="text-align: right;">SSP.2</th>
<th style="text-align: right;">SSW.2</th>
<th style="text-align: right;">ACE.2</th>
<th style="text-align: right;">DBF.2</th>
<th style="text-align: right;">WNR.2</th>
<th style="text-align: right;">UFE.2</th>
<th style="text-align: right;">BPC.2</th>
<th style="text-align: right;">BPW.2</th>
<th style="text-align: right;">NPA.2</th>
<th style="text-align: right;">NPW.2</th>
<th style="text-align: right;">TPW.2</th>
<th style="text-align: right;">ST1.2</th>
<th style="text-align: right;">ST2.2</th>
<th style="text-align: right;">ST3.2</th>
<th style="text-align: right;">ST4.2</th>
<th style="text-align: right;">ST5.2</th>
<th style="text-align: left;">TOURNAMENT</th>
<th style="text-align: left;">GENDER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">938</td>
<td style="text-align: left;">S.Stephens</td>
<td style="text-align: left;">M.Bartoli</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">939</td>
<td style="text-align: left;">A.Radwanska</td>
<td style="text-align: left;">N.Li</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="odd">
<td style="text-align: left;">940</td>
<td style="text-align: left;">S.Lisicki</td>
<td style="text-align: left;">K.Kanepi</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">941</td>
<td style="text-align: left;">M.Bartoli</td>
<td style="text-align: left;">K.Flipkens</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="odd">
<td style="text-align: left;">942</td>
<td style="text-align: left;">S.Lisicki</td>
<td style="text-align: left;">A.Radwanska</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">943</td>
<td style="text-align: left;">S.Lisicki</td>
<td style="text-align: left;">M.Bartoli</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As seen on the “PLAYER1” and “PLAYER2”, there is problem about how player names saved to data. In some rows player names saved as full name (first name + surname). However, in other rows, player names saved as shortened way like “M.Bartolli”. This problem fixed by convert all names shortened.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Function that shortened names as like "M.Bartolli"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>convert_player_name <span class="ot">&lt;-</span> <span class="cf">function</span>(player_name){</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  name_parts <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(player_name, <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  first_name <span class="ot">&lt;-</span> name_parts[<span class="dv">1</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, first_name) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">s"</span>, player_name))){</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(first_name)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">-"</span>, first_name)){</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    other_names <span class="ot">&lt;-</span> name_parts[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    first_name_parts <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(first_name, <span class="st">"-"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    first_name_parts_1 <span class="ot">&lt;-</span> first_name_parts[<span class="dv">1</span>]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    first_name_parts_2 <span class="ot">&lt;-</span> first_name_parts[<span class="dv">2</span>]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    first_initial_1 <span class="ot">&lt;-</span> <span class="fu">substr</span>(first_name_parts_1, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    first_initial_2 <span class="ot">&lt;-</span> <span class="fu">substr</span>(first_name_parts_2, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    first_initial <span class="ot">&lt;-</span> <span class="fu">paste0</span>(first_initial_1, <span class="st">"-"</span>, first_initial_2)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    remaining_name <span class="ot">&lt;-</span> <span class="fu">paste</span>(name_parts[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    new_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(first_initial, <span class="st">"."</span>, remaining_name)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(new_name)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    other_names <span class="ot">&lt;-</span> name_parts[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    first_initial <span class="ot">&lt;-</span> <span class="fu">substr</span>(first_name, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    remaining_name <span class="ot">&lt;-</span> <span class="fu">paste</span>(name_parts[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    new_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(first_initial, <span class="st">"."</span>, remaining_name)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(new_name)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to each element of the player name column</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>converted_names_1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(GrandSlam<span class="sc">$</span>PLAYER1, convert_player_name)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>converted_names_2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(GrandSlam<span class="sc">$</span>PLAYER2, convert_player_name)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>PLAYER1<span class="ot">&lt;-</span> converted_names_1</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>PLAYER2 <span class="ot">&lt;-</span> converted_names_2</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#There is some cases names are saved diffrent way for the same player, This function fixed that problem</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>fixed_name <span class="ot">&lt;-</span> <span class="cf">function</span>(player_name){</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"T.De"</span>,player_name) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">"T.de"</span>,player_name)){</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"T.De Bakker"</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"P.Carreno"</span>,player_name)){</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"P.Carreno"</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"Koehler"</span>,player_name)){</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"M.Koehler"</span>)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"Pliskova"</span>,player_name)){</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"K.Pliskova"</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"Struff"</span>,player_name)){</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"J.Struff"</span>)</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"Struff"</span>,player_name)){</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"J.Struff"</span>)</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"Begu"</span>,player_name)){</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"I.Begu"</span>)</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"C.Suarez"</span>,player_name)){</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"C.Suarez"</span>)</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"C.Wozniack"</span>,player_name)){</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"C.Wozniack"</span>)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"B.Zahlavova"</span>,player_name)){</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"B.Zahlavova"</span>)</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"A.Medina"</span>,player_name)){</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"A.Medina"</span>)</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"A.Bogomolov"</span>,player_name)){</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"A.Bogomolov"</span>)</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"Schmiedlova"</span>,player_name)){</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"A.Schmiedlova"</span>)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"Torro-Flor"</span>,player_name)){</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"M.Torro-Flor"</span>)</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(player_name)</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>fixed1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(GrandSlam<span class="sc">$</span>PLAYER1,fixed_name)</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>fixed2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(GrandSlam<span class="sc">$</span>PLAYER2,fixed_name)</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>PLAYER1 <span class="ot">&lt;-</span> fixed1</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>PLAYER2 <span class="ot">&lt;-</span> fixed2</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>all_player<span class="ot">=</span><span class="fu">c</span>(GrandSlam<span class="sc">$</span>PLAYER1,GrandSlam<span class="sc">$</span>PLAYER2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After fixed player names, there is 358 player on this data set.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(GrandSlam), <span class="at">label =</span> <span class="st">"Head of the data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">PLAYER1</th>
<th style="text-align: left;">PLAYER2</th>
<th style="text-align: right;">ROUND</th>
<th style="text-align: right;">RESULT</th>
<th style="text-align: right;">FNL.1</th>
<th style="text-align: right;">FNL.2</th>
<th style="text-align: right;">FSP.1</th>
<th style="text-align: right;">FSW.1</th>
<th style="text-align: right;">SSP.1</th>
<th style="text-align: right;">SSW.1</th>
<th style="text-align: right;">ACE.1</th>
<th style="text-align: right;">DBF.1</th>
<th style="text-align: right;">WNR.1</th>
<th style="text-align: right;">UFE.1</th>
<th style="text-align: right;">BPC.1</th>
<th style="text-align: right;">BPW.1</th>
<th style="text-align: right;">NPA.1</th>
<th style="text-align: right;">NPW.1</th>
<th style="text-align: right;">TPW.1</th>
<th style="text-align: right;">ST1.1</th>
<th style="text-align: right;">ST2.1</th>
<th style="text-align: right;">ST3.1</th>
<th style="text-align: right;">ST4.1</th>
<th style="text-align: right;">ST5.1</th>
<th style="text-align: right;">FSP.2</th>
<th style="text-align: right;">FSW.2</th>
<th style="text-align: right;">SSP.2</th>
<th style="text-align: right;">SSW.2</th>
<th style="text-align: right;">ACE.2</th>
<th style="text-align: right;">DBF.2</th>
<th style="text-align: right;">WNR.2</th>
<th style="text-align: right;">UFE.2</th>
<th style="text-align: right;">BPC.2</th>
<th style="text-align: right;">BPW.2</th>
<th style="text-align: right;">NPA.2</th>
<th style="text-align: right;">NPW.2</th>
<th style="text-align: right;">TPW.2</th>
<th style="text-align: right;">ST1.2</th>
<th style="text-align: right;">ST2.2</th>
<th style="text-align: right;">ST3.2</th>
<th style="text-align: right;">ST4.2</th>
<th style="text-align: right;">ST5.2</th>
<th style="text-align: left;">TOURNAMENT</th>
<th style="text-align: left;">GENDER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">L.Lacko</td>
<td style="text-align: left;">N.Djokovic</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">L.Mayer</td>
<td style="text-align: left;">A.Montanes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M.Baghdatis</td>
<td style="text-align: left;">D.Istomin</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">D.Tursunov</td>
<td style="text-align: left;">M.Russell</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="odd">
<td style="text-align: left;">J.Monaco</td>
<td style="text-align: left;">E.Gulbis</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">S.Giraldo</td>
<td style="text-align: left;">S.Querrey</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">AusOpen</td>
<td style="text-align: left;">M</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tail</span>(GrandSlam),<span class="at">label =</span> <span class="st">"Tail of the data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">PLAYER1</th>
<th style="text-align: left;">PLAYER2</th>
<th style="text-align: right;">ROUND</th>
<th style="text-align: right;">RESULT</th>
<th style="text-align: right;">FNL.1</th>
<th style="text-align: right;">FNL.2</th>
<th style="text-align: right;">FSP.1</th>
<th style="text-align: right;">FSW.1</th>
<th style="text-align: right;">SSP.1</th>
<th style="text-align: right;">SSW.1</th>
<th style="text-align: right;">ACE.1</th>
<th style="text-align: right;">DBF.1</th>
<th style="text-align: right;">WNR.1</th>
<th style="text-align: right;">UFE.1</th>
<th style="text-align: right;">BPC.1</th>
<th style="text-align: right;">BPW.1</th>
<th style="text-align: right;">NPA.1</th>
<th style="text-align: right;">NPW.1</th>
<th style="text-align: right;">TPW.1</th>
<th style="text-align: right;">ST1.1</th>
<th style="text-align: right;">ST2.1</th>
<th style="text-align: right;">ST3.1</th>
<th style="text-align: right;">ST4.1</th>
<th style="text-align: right;">ST5.1</th>
<th style="text-align: right;">FSP.2</th>
<th style="text-align: right;">FSW.2</th>
<th style="text-align: right;">SSP.2</th>
<th style="text-align: right;">SSW.2</th>
<th style="text-align: right;">ACE.2</th>
<th style="text-align: right;">DBF.2</th>
<th style="text-align: right;">WNR.2</th>
<th style="text-align: right;">UFE.2</th>
<th style="text-align: right;">BPC.2</th>
<th style="text-align: right;">BPW.2</th>
<th style="text-align: right;">NPA.2</th>
<th style="text-align: right;">NPW.2</th>
<th style="text-align: right;">TPW.2</th>
<th style="text-align: right;">ST1.2</th>
<th style="text-align: right;">ST2.2</th>
<th style="text-align: right;">ST3.2</th>
<th style="text-align: right;">ST4.2</th>
<th style="text-align: right;">ST5.2</th>
<th style="text-align: left;">TOURNAMENT</th>
<th style="text-align: left;">GENDER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">938</td>
<td style="text-align: left;">S.Stephens</td>
<td style="text-align: left;">M.Bartoli</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">939</td>
<td style="text-align: left;">A.Radwanska</td>
<td style="text-align: left;">N.Li</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="odd">
<td style="text-align: left;">940</td>
<td style="text-align: left;">S.Lisicki</td>
<td style="text-align: left;">K.Kanepi</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">941</td>
<td style="text-align: left;">M.Bartoli</td>
<td style="text-align: left;">K.Flipkens</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="odd">
<td style="text-align: left;">942</td>
<td style="text-align: left;">S.Lisicki</td>
<td style="text-align: left;">A.Radwanska</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">943</td>
<td style="text-align: left;">S.Lisicki</td>
<td style="text-align: left;">M.Bartoli</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: left;">F</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As seen on the head and tail of the data, data seems well tabulated data. There is no unnecessary columns. There is 0 duplicated observations in the data set. Player names fixed too.</p>
<p>Now character values, “Round” and “Result” can be changed to factor. And finalize structure of the data is below:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Change 'Result' value for player-1 1 and player-2 2:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>RESULT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(GrandSlam<span class="sc">$</span>RESULT<span class="sc">==</span><span class="dv">0</span>, <span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert variables to factor</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>PLAYER1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(GrandSlam<span class="sc">$</span>PLAYER1)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>PLAYER2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(GrandSlam<span class="sc">$</span>PLAYER2)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>RESULT <span class="ot">&lt;-</span><span class="fu">factor</span>(GrandSlam<span class="sc">$</span>RESULT)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>ROUND <span class="ot">&lt;-</span><span class="fu">factor</span>(GrandSlam<span class="sc">$</span>ROUND)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>TOURNAMENT <span class="ot">&lt;-</span><span class="fu">factor</span>(GrandSlam<span class="sc">$</span>TOURNAMENT)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>GENDER <span class="ot">&lt;-</span><span class="fu">factor</span>(GrandSlam<span class="sc">$</span>GENDER)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(GrandSlam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   943 obs. of  44 variables:
 $ PLAYER1   : Factor w/ 308 levels "A.Barty","A.Beck",..: 161 162 169 70 126 252 68 85 62 205 ...
 $ PLAYER2   : Factor w/ 309 levels "A.Barty","A.Beck",..: 213 22 69 205 82 260 139 4 237 167 ...
 $ ROUND     : Factor w/ 7 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ RESULT    : Factor w/ 2 levels "1","2": 2 1 2 1 2 2 2 1 2 1 ...
 $ FNL.1     : int  0 3 0 3 1 1 2 2 0 3 ...
 $ FNL.2     : int  3 0 3 0 3 3 3 0 3 2 ...
 $ FSP.1     : int  61 61 52 53 76 65 68 47 64 77 ...
 $ FSW.1     : int  35 31 53 39 63 51 73 18 26 76 ...
 $ SSP.1     : int  39 39 48 47 24 35 32 53 36 23 ...
 $ SSW.1     : int  18 13 20 24 12 22 24 15 12 11 ...
 $ ACE.1     : int  5 13 8 8 0 9 5 3 3 6 ...
 $ DBF.1     : int  1 1 4 6 4 3 3 4 NA 4 ...
 $ WNR.1     : int  17 13 37 8 16 35 41 21 20 6 ...
 $ UFE.1     : int  29 1 50 6 35 41 50 31 39 4 ...
 $ BPC.1     : int  1 7 1 6 3 2 9 6 3 7 ...
 $ BPW.1     : int  3 14 9 9 12 7 17 20 7 24 ...
 $ NPA.1     : int  8 NA 16 NA 9 6 14 6 5 NA ...
 $ NPW.1     : int  11 NA 23 NA 13 12 30 9 14 NA ...
 $ TPW.1     : int  70 80 106 104 128 108 173 78 67 162 ...
 $ ST1.1     : int  3 6 4 6 6 3 6 6 5 3 ...
 $ ST2.1     : int  6 6 5 6 4 2 6 6 4 6 ...
 $ ST3.1     : int  1 6 4 6 6 6 7 NA 1 3 ...
 $ ST4.1     : int  NA NA NA NA 2 6 3 NA NA 6 ...
 $ ST5.1     : int  NA NA NA NA NA NA 3 NA NA 6 ...
 $ FSP.2     : num  68 60 77 50 53 63 60 54 67 60 ...
 $ FSW.2     : int  45 23 57 24 59 60 66 26 42 68 ...
 $ SSP.2     : int  32 40 23 50 47 37 40 46 33 40 ...
 $ SSW.2     : int  17 9 15 19 32 22 34 13 14 25 ...
 $ ACE.2     : int  10 1 9 1 17 24 2 0 12 8 ...
 $ DBF.2     : int  0 4 1 8 11 4 6 11 NA 12 ...
 $ WNR.2     : int  40 1 41 1 59 47 57 11 32 8 ...
 $ UFE.2     : int  30 4 41 8 79 45 72 46 20 12 ...
 $ BPC.2     : int  4 0 4 1 3 4 10 2 7 6 ...
 $ BPW.2     : int  8 0 13 7 5 7 17 6 10 14 ...
 $ NPA.2     : int  8 NA 12 NA 16 14 25 8 8 NA ...
 $ NPW.2     : int  9 NA 16 NA 28 17 36 12 11 NA ...
 $ TPW.2     : int  101 42 126 79 127 122 173 61 94 141 ...
 $ ST1.2     : int  6 1 6 2 1 6 3 3 7 6 ...
 $ ST2.2     : int  7 3 7 2 6 6 7 2 6 3 ...
 $ ST3.2     : int  6 1 6 3 7 3 6 NA 6 6 ...
 $ ST4.2     : int  NA NA NA NA 6 7 6 NA NA 3 ...
 $ ST5.2     : int  NA NA NA NA NA NA 6 NA NA 4 ...
 $ TOURNAMENT: Factor w/ 4 levels "AusOpen","FrenchOpen",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ GENDER    : Factor w/ 2 levels "F","M": 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
</div>
<p>Also there is problem about BPC(Break Points Created) and BPW(Break Points Win). Logically, BPC must be greater or equal to BPW but in some rows BPC is lower than BPW like below example. This fixed by exchanging BPC values by BPW and BPW values by BPC when BPW &gt; BPC.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cond<span class="ot">&lt;-</span><span class="fu">which</span>(GrandSlam<span class="sc">$</span>BPW<span class="fl">.1</span><span class="sc">&gt;</span>GrandSlam<span class="sc">$</span>BPC<span class="fl">.1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GrandSlam[cond,<span class="fu">c</span>(<span class="st">"BPC.1"</span>,<span class="st">"BPW.1"</span>,<span class="st">"BPC.2"</span>,<span class="st">"BPW.2"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  BPC.1 BPW.1 BPC.2 BPW.2
1     1     3     4     8
2     7    14     0     0
3     1     9     4    13
4     6     9     1     7
5     3    12     3     5
6     2     7     4     7</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(GrandSlam<span class="sc">$</span>PLAYER1)){</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>BPC<span class="fl">.1</span>[i] <span class="sc">&lt;</span> GrandSlam<span class="sc">$</span>BPW<span class="fl">.1</span>[i])){</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(GrandSlam<span class="sc">$</span>BPC<span class="fl">.1</span>[i] <span class="sc">&lt;</span> GrandSlam<span class="sc">$</span>BPW<span class="fl">.1</span>[i]){</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    old_BPC <span class="ot">&lt;-</span> GrandSlam<span class="sc">$</span>BPC<span class="fl">.1</span>[i]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    old_BPW <span class="ot">&lt;-</span> GrandSlam<span class="sc">$</span>BPW<span class="fl">.1</span>[i]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    GrandSlam<span class="sc">$</span>BPC<span class="fl">.1</span>[i] <span class="ot">&lt;-</span> old_BPW</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    GrandSlam<span class="sc">$</span>BPW<span class="fl">.1</span>[i] <span class="ot">&lt;-</span> old_BPC</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(GrandSlam<span class="sc">$</span>BPC<span class="fl">.2</span>[i] <span class="sc">&lt;</span> GrandSlam<span class="sc">$</span>BPW<span class="fl">.2</span>[i]){</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    old_BPC <span class="ot">&lt;-</span> GrandSlam<span class="sc">$</span>BPC<span class="fl">.2</span>[i]</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    old_BPW <span class="ot">&lt;-</span> GrandSlam<span class="sc">$</span>BPW<span class="fl">.2</span>[i]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    GrandSlam<span class="sc">$</span>BPC<span class="fl">.2</span>[i] <span class="ot">&lt;-</span> old_BPW</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    GrandSlam<span class="sc">$</span>BPW<span class="fl">.2</span>[i] <span class="ot">&lt;-</span> old_BPC</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There are similar problems with NPA and NPW for Aus open and French Open tournaments, NPA should be greater or equal to NPW. This fixed by exchanging NPA values by NPW and NPW values by NPA when NPW &gt; NPA.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cond<span class="ot">&lt;-</span><span class="fu">which</span>(GrandSlam<span class="sc">$</span>NPW<span class="fl">.1</span><span class="sc">&gt;</span>GrandSlam<span class="sc">$</span>NPA<span class="fl">.1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GrandSlam[cond,<span class="fu">c</span>(<span class="st">"NPA.1"</span>,<span class="st">"NPW.1"</span>,<span class="st">"NPA.2"</span>,<span class="st">"NPW.2"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  NPA.1 NPW.1 NPA.2 NPW.2
1     8    11     8     9
3    16    23    12    16
5     9    13    16    28
6     6    12    14    17
7    14    30    25    36
8     6     9     8    12</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(GrandSlam<span class="sc">$</span>PLAYER1)){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>NPA<span class="fl">.1</span>[i] <span class="sc">&lt;</span> GrandSlam<span class="sc">$</span>NPW<span class="fl">.1</span>[i])){</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(GrandSlam<span class="sc">$</span>NPA<span class="fl">.1</span>[i] <span class="sc">&lt;</span> GrandSlam<span class="sc">$</span>NPW<span class="fl">.1</span>[i]){</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    old_NPA <span class="ot">&lt;-</span> GrandSlam<span class="sc">$</span>NPA<span class="fl">.1</span>[i]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    old_NPW <span class="ot">&lt;-</span> GrandSlam<span class="sc">$</span>NPW<span class="fl">.1</span>[i]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    GrandSlam<span class="sc">$</span>NPA<span class="fl">.1</span>[i] <span class="ot">&lt;-</span> old_NPW</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    GrandSlam<span class="sc">$</span>NPW<span class="fl">.1</span>[i] <span class="ot">&lt;-</span> old_NPA</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(GrandSlam<span class="sc">$</span>NPA<span class="fl">.2</span>[i] <span class="sc">&lt;</span> GrandSlam<span class="sc">$</span>NPW<span class="fl">.2</span>[i]){</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    old_NPA <span class="ot">&lt;-</span> GrandSlam<span class="sc">$</span>NPA<span class="fl">.2</span>[i]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    old_NPW <span class="ot">&lt;-</span> GrandSlam<span class="sc">$</span>NPW<span class="fl">.2</span>[i]</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    GrandSlam<span class="sc">$</span>NPA<span class="fl">.2</span>[i] <span class="ot">&lt;-</span> old_NPW</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    GrandSlam<span class="sc">$</span>NPW<span class="fl">.2</span>[i] <span class="ot">&lt;-</span> old_NPA</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After fix the problem, all BPC values are greater than BPW. Same for NPA and NPW.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GrandSlam[cond,<span class="fu">c</span>(<span class="st">"BPC.1"</span>,<span class="st">"BPW.1"</span>,<span class="st">"BPC.2"</span>,<span class="st">"BPW.2"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  BPC.1 BPW.1 BPC.2 BPW.2
1     3     1     8     4
3     9     1    13     4
5    12     3     5     3
6     7     2     7     4
7    17     9    17    10
8    20     6     6     2</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GrandSlam[cond,<span class="fu">c</span>(<span class="st">"NPA.1"</span>,<span class="st">"NPW.1"</span>,<span class="st">"NPA.2"</span>,<span class="st">"NPW.2"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  NPA.1 NPW.1 NPA.2 NPW.2
1    11     8     9     8
3    23    16    16    12
5    13     9    28    16
6    12     6    17    14
7    30    14    36    25
8     9     6    12     8</code></pre>
</div>
</div>
</section>
<section id="explanatory-data-analysiseda-and-confirmatory-data-analysiscda" class="level2">
<h2 class="anchored" data-anchor-id="explanatory-data-analysiseda-and-confirmatory-data-analysiscda">4. Explanatory Data Analysis(EDA) and Confirmatory Data Analysis(CDA)</h2>
<section id="summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h3>
<p>Below there are frequency tables for tournament, round, result and gender. Ausopen and French open tournaments have most number of match. Also, as expected most matches played at round 1. Number of male matches are greater than female matches. Moreover, Most round 1 matches played at US open, but at the remaining round US Open matches are not much when considering other tournaments. There can be incomplete data for US Open.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Frequency table for categorical</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">table</span>(GrandSlam<span class="sc">$</span>TOURNAMENT),<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">'Tournament'</span>,<span class="st">'Freq'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Tournament</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AusOpen</td>
<td style="text-align: right;">253</td>
</tr>
<tr class="even">
<td style="text-align: left;">FrenchOpen</td>
<td style="text-align: right;">252</td>
</tr>
<tr class="odd">
<td style="text-align: left;">USopen</td>
<td style="text-align: right;">202</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: right;">236</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">table</span>(GrandSlam<span class="sc">$</span>ROUND),<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">'Round'</span>,<span class="st">'Freq'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Round</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">536</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">197</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">107</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">table</span>(GrandSlam<span class="sc">$</span>RESULT),<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">'Result'</span>,<span class="st">'Freq'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Result</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">465</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">478</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">table</span>(GrandSlam<span class="sc">$</span>GENDER),<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">'Gender'</span>,<span class="st">'Freq'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Gender</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">F</td>
<td style="text-align: right;">452</td>
</tr>
<tr class="even">
<td style="text-align: left;">M</td>
<td style="text-align: right;">491</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">table</span>(GrandSlam<span class="sc">$</span>TOURNAMENT,GrandSlam<span class="sc">$</span>ROUND))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
<th style="text-align: right;">7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AusOpen</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">FrenchOpen</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">USopen</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wimbledon</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Summary statistics for numeric variables are below. Avarage performances are almost equal for player 1 and player 2 statistics. Avarage performance of tennis players can be seen in this summary statistics.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(GrandSlam))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">PLAYER1</th>
<th style="text-align: left;">PLAYER2</th>
<th style="text-align: left;">ROUND</th>
<th style="text-align: left;">RESULT</th>
<th style="text-align: left;">FNL.1</th>
<th style="text-align: left;">FNL.2</th>
<th style="text-align: left;">FSP.1</th>
<th style="text-align: left;">FSW.1</th>
<th style="text-align: left;">SSP.1</th>
<th style="text-align: left;">SSW.1</th>
<th style="text-align: left;">ACE.1</th>
<th style="text-align: left;">DBF.1</th>
<th style="text-align: left;">WNR.1</th>
<th style="text-align: left;">UFE.1</th>
<th style="text-align: left;">BPC.1</th>
<th style="text-align: left;">BPW.1</th>
<th style="text-align: left;">NPA.1</th>
<th style="text-align: left;">NPW.1</th>
<th style="text-align: left;">TPW.1</th>
<th style="text-align: left;">ST1.1</th>
<th style="text-align: left;">ST2.1</th>
<th style="text-align: left;">ST3.1</th>
<th style="text-align: left;">ST4.1</th>
<th style="text-align: left;">ST5.1</th>
<th style="text-align: left;">FSP.2</th>
<th style="text-align: left;">FSW.2</th>
<th style="text-align: left;">SSP.2</th>
<th style="text-align: left;">SSW.2</th>
<th style="text-align: left;">ACE.2</th>
<th style="text-align: left;">DBF.2</th>
<th style="text-align: left;">WNR.2</th>
<th style="text-align: left;">UFE.2</th>
<th style="text-align: left;">BPC.2</th>
<th style="text-align: left;">BPW.2</th>
<th style="text-align: left;">NPA.2</th>
<th style="text-align: left;">NPW.2</th>
<th style="text-align: left;">TPW.2</th>
<th style="text-align: left;">ST1.2</th>
<th style="text-align: left;">ST2.2</th>
<th style="text-align: left;">ST3.2</th>
<th style="text-align: left;">ST4.2</th>
<th style="text-align: left;">ST5.2</th>
<th style="text-align: left;">TOURNAMENT</th>
<th style="text-align: left;">GENDER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">S.Williams : 21</td>
<td style="text-align: left;">V.Azarenka : 18</td>
<td style="text-align: left;">1:536</td>
<td style="text-align: left;">1:465</td>
<td style="text-align: left;">Min. :0.00</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :38.00</td>
<td style="text-align: left;">Min. : 3.00</td>
<td style="text-align: left;">Min. :14.00</td>
<td style="text-align: left;">Min. : 1.00</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.000</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.000</td>
<td style="text-align: left;">Min. : 0.000</td>
<td style="text-align: left;">Min. : 1.00</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 5.00</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 7.00</td>
<td style="text-align: left;">Min. : 1.00</td>
<td style="text-align: left;">Min. : 0.000</td>
<td style="text-align: left;">Min. : 0.000</td>
<td style="text-align: left;">Min. : 0.0</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.000</td>
<td style="text-align: left;">Min. : 0.000</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 1.00</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.000</td>
<td style="text-align: left;">Min. :0.00</td>
<td style="text-align: left;">Min. :1.000</td>
<td style="text-align: left;">AusOpen :253</td>
<td style="text-align: left;">F:452</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">N.Djokovic : 19</td>
<td style="text-align: left;">D.Ferrer : 16</td>
<td style="text-align: left;">2:197</td>
<td style="text-align: left;">2:478</td>
<td style="text-align: left;">1st Qu.:0.00</td>
<td style="text-align: left;">1st Qu.:0.000</td>
<td style="text-align: left;">1st Qu.:57.00</td>
<td style="text-align: left;">1st Qu.: 26.00</td>
<td style="text-align: left;">1st Qu.:33.00</td>
<td style="text-align: left;">1st Qu.:10.00</td>
<td style="text-align: left;">1st Qu.: 2.00</td>
<td style="text-align: left;">1st Qu.: 2.000</td>
<td style="text-align: left;">1st Qu.: 16.00</td>
<td style="text-align: left;">1st Qu.:17.00</td>
<td style="text-align: left;">1st Qu.: 5.000</td>
<td style="text-align: left;">1st Qu.: 2.000</td>
<td style="text-align: left;">1st Qu.:10.00</td>
<td style="text-align: left;">1st Qu.: 6.00</td>
<td style="text-align: left;">1st Qu.: 67.00</td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:4.000</td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:57.00</td>
<td style="text-align: left;">1st Qu.: 25.00</td>
<td style="text-align: left;">1st Qu.: 33.00</td>
<td style="text-align: left;">1st Qu.:10.00</td>
<td style="text-align: left;">1st Qu.: 1.000</td>
<td style="text-align: left;">1st Qu.: 2.000</td>
<td style="text-align: left;">1st Qu.:16.0</td>
<td style="text-align: left;">1st Qu.:16.00</td>
<td style="text-align: left;">1st Qu.: 5.000</td>
<td style="text-align: left;">1st Qu.: 2.000</td>
<td style="text-align: left;">1st Qu.:10.00</td>
<td style="text-align: left;">1st Qu.: 6.00</td>
<td style="text-align: left;">1st Qu.: 64.00</td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:3.000</td>
<td style="text-align: left;">1st Qu.:3.00</td>
<td style="text-align: left;">1st Qu.:4.000</td>
<td style="text-align: left;">FrenchOpen:252</td>
<td style="text-align: left;">M:491</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">A.Radwanska: 17</td>
<td style="text-align: left;">M.Sharapova: 13</td>
<td style="text-align: left;">3:107</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Median :2.00</td>
<td style="text-align: left;">Median :2.000</td>
<td style="text-align: left;">Median :62.00</td>
<td style="text-align: left;">Median : 37.00</td>
<td style="text-align: left;">Median :38.00</td>
<td style="text-align: left;">Median :15.00</td>
<td style="text-align: left;">Median : 4.00</td>
<td style="text-align: left;">Median : 3.000</td>
<td style="text-align: left;">Median : 25.00</td>
<td style="text-align: left;">Median :26.00</td>
<td style="text-align: left;">Median : 9.000</td>
<td style="text-align: left;">Median : 4.000</td>
<td style="text-align: left;">Median :17.00</td>
<td style="text-align: left;">Median :11.00</td>
<td style="text-align: left;">Median : 91.00</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :5.000</td>
<td style="text-align: left;">Median :62.00</td>
<td style="text-align: left;">Median : 36.00</td>
<td style="text-align: left;">Median : 38.00</td>
<td style="text-align: left;">Median :16.00</td>
<td style="text-align: left;">Median : 4.000</td>
<td style="text-align: left;">Median : 3.000</td>
<td style="text-align: left;">Median :26.0</td>
<td style="text-align: left;">Median :26.00</td>
<td style="text-align: left;">Median : 8.000</td>
<td style="text-align: left;">Median : 4.000</td>
<td style="text-align: left;">Median :17.00</td>
<td style="text-align: left;">Median :11.00</td>
<td style="text-align: left;">Median : 92.00</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">Median :6.00</td>
<td style="text-align: left;">Median :6.000</td>
<td style="text-align: left;">USopen :202</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">R.Nadal : 14</td>
<td style="text-align: left;">R.Federer : 13</td>
<td style="text-align: left;">4: 55</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Mean :1.49</td>
<td style="text-align: left;">Mean :1.493</td>
<td style="text-align: left;">Mean :62.26</td>
<td style="text-align: left;">Mean : 38.79</td>
<td style="text-align: left;">Mean :37.79</td>
<td style="text-align: left;">Mean :16.73</td>
<td style="text-align: left;">Mean : 6.14</td>
<td style="text-align: left;">Mean : 3.642</td>
<td style="text-align: left;">Mean : 27.54</td>
<td style="text-align: left;">Mean :27.28</td>
<td style="text-align: left;">Mean : 8.792</td>
<td style="text-align: left;">Mean : 3.663</td>
<td style="text-align: left;">Mean :19.85</td>
<td style="text-align: left;">Mean :12.86</td>
<td style="text-align: left;">Mean : 94.28</td>
<td style="text-align: left;">Mean :4.801</td>
<td style="text-align: left;">Mean :4.781</td>
<td style="text-align: left;">Mean :4.728</td>
<td style="text-align: left;">Mean :4.787</td>
<td style="text-align: left;">Mean :4.651</td>
<td style="text-align: left;">Mean :61.97</td>
<td style="text-align: left;">Mean : 38.69</td>
<td style="text-align: left;">Mean : 38.05</td>
<td style="text-align: left;">Mean :16.93</td>
<td style="text-align: left;">Mean : 5.983</td>
<td style="text-align: left;">Mean : 3.772</td>
<td style="text-align: left;">Mean :27.8</td>
<td style="text-align: left;">Mean :27.68</td>
<td style="text-align: left;">Mean : 8.648</td>
<td style="text-align: left;">Mean : 3.657</td>
<td style="text-align: left;">Mean :20.25</td>
<td style="text-align: left;">Mean :13.29</td>
<td style="text-align: left;">Mean : 94.52</td>
<td style="text-align: left;">Mean :4.816</td>
<td style="text-align: left;">Mean :4.695</td>
<td style="text-align: left;">Mean :4.823</td>
<td style="text-align: left;">Mean :4.71</td>
<td style="text-align: left;">Mean :5.128</td>
<td style="text-align: left;">Wimbledon :236</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">J.Jankovic : 13</td>
<td style="text-align: left;">N.Li : 12</td>
<td style="text-align: left;">5: 27</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">3rd Qu.:2.00</td>
<td style="text-align: left;">3rd Qu.:3.000</td>
<td style="text-align: left;">3rd Qu.:67.00</td>
<td style="text-align: left;">3rd Qu.: 49.00</td>
<td style="text-align: left;">3rd Qu.:43.00</td>
<td style="text-align: left;">3rd Qu.:22.00</td>
<td style="text-align: left;">3rd Qu.: 8.00</td>
<td style="text-align: left;">3rd Qu.: 5.000</td>
<td style="text-align: left;">3rd Qu.: 36.00</td>
<td style="text-align: left;">3rd Qu.:36.00</td>
<td style="text-align: left;">3rd Qu.:12.000</td>
<td style="text-align: left;">3rd Qu.: 5.000</td>
<td style="text-align: left;">3rd Qu.:26.50</td>
<td style="text-align: left;">3rd Qu.:17.00</td>
<td style="text-align: left;">3rd Qu.:116.00</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:67.00</td>
<td style="text-align: left;">3rd Qu.: 48.50</td>
<td style="text-align: left;">3rd Qu.: 43.50</td>
<td style="text-align: left;">3rd Qu.:22.00</td>
<td style="text-align: left;">3rd Qu.: 9.000</td>
<td style="text-align: left;">3rd Qu.: 5.000</td>
<td style="text-align: left;">3rd Qu.:37.0</td>
<td style="text-align: left;">3rd Qu.:37.00</td>
<td style="text-align: left;">3rd Qu.:12.000</td>
<td style="text-align: left;">3rd Qu.: 5.000</td>
<td style="text-align: left;">3rd Qu.:27.00</td>
<td style="text-align: left;">3rd Qu.:18.25</td>
<td style="text-align: left;">3rd Qu.:119.00</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">3rd Qu.:6.00</td>
<td style="text-align: left;">3rd Qu.:6.000</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">A.Cornet : 12</td>
<td style="text-align: left;">A.Ivanovic : 10</td>
<td style="text-align: left;">6: 14</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Max. :3.00</td>
<td style="text-align: left;">Max. :3.000</td>
<td style="text-align: left;">Max. :86.00</td>
<td style="text-align: left;">Max. :109.00</td>
<td style="text-align: left;">Max. :62.00</td>
<td style="text-align: left;">Max. :52.00</td>
<td style="text-align: left;">Max. :41.00</td>
<td style="text-align: left;">Max. :18.000</td>
<td style="text-align: left;">Max. :111.00</td>
<td style="text-align: left;">Max. :89.00</td>
<td style="text-align: left;">Max. :28.000</td>
<td style="text-align: left;">Max. :11.000</td>
<td style="text-align: left;">Max. :96.00</td>
<td style="text-align: left;">Max. :62.00</td>
<td style="text-align: left;">Max. :231.00</td>
<td style="text-align: left;">Max. :7.000</td>
<td style="text-align: left;">Max. :7.000</td>
<td style="text-align: left;">Max. :9.000</td>
<td style="text-align: left;">Max. :7.000</td>
<td style="text-align: left;">Max. :9.000</td>
<td style="text-align: left;">Max. :93.00</td>
<td style="text-align: left;">Max. :132.00</td>
<td style="text-align: left;">Max. :100.00</td>
<td style="text-align: left;">Max. :57.00</td>
<td style="text-align: left;">Max. :39.000</td>
<td style="text-align: left;">Max. :18.000</td>
<td style="text-align: left;">Max. :95.0</td>
<td style="text-align: left;">Max. :96.00</td>
<td style="text-align: left;">Max. :26.000</td>
<td style="text-align: left;">Max. :11.000</td>
<td style="text-align: left;">Max. :82.00</td>
<td style="text-align: left;">Max. :52.00</td>
<td style="text-align: left;">Max. :230.00</td>
<td style="text-align: left;">Max. :7.000</td>
<td style="text-align: left;">Max. :7.000</td>
<td style="text-align: left;">Max. :9.000</td>
<td style="text-align: left;">Max. :7.00</td>
<td style="text-align: left;">Max. :9.000</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">(Other) :847</td>
<td style="text-align: left;">(Other) :861</td>
<td style="text-align: left;">7: 7</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA’s :22</td>
<td style="text-align: left;">NA’s :8</td>
<td style="text-align: left;">NA’s :126</td>
<td style="text-align: left;">NA’s :126</td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA’s :84</td>
<td style="text-align: left;">NA’s :83</td>
<td style="text-align: left;">NA’s :312</td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA’s :4</td>
<td style="text-align: left;">NA’s :321</td>
<td style="text-align: left;">NA’s :722</td>
<td style="text-align: left;">NA’s :857</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA’s :22</td>
<td style="text-align: left;">NA’s :8</td>
<td style="text-align: left;">NA’s :126</td>
<td style="text-align: left;">NA’s :126</td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA’s :84</td>
<td style="text-align: left;">NA’s :83</td>
<td style="text-align: left;">NA’s :312</td>
<td style="text-align: left;">NA’s :1</td>
<td style="text-align: left;">NA’s :4</td>
<td style="text-align: left;">NA’s :321</td>
<td style="text-align: left;">NA’s :722</td>
<td style="text-align: left;">NA’s :857</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Also, set result summary is like below, as seen, there are a lot of NA values for ST4 and ST5 especially. This is because most of the match is not last to 5 or 4 set. It is over in 2 or 3 sets.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sum8 <span class="ot">&lt;-</span>GrandSlam <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ST1<span class="fl">.1</span>,ST2<span class="fl">.1</span>,ST3<span class="fl">.1</span>,ST4<span class="fl">.1</span>,ST5<span class="fl">.1</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sum8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     ST1.1           ST2.1           ST3.1           ST4.1      
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:3.000   1st Qu.:4.000   1st Qu.:3.000   1st Qu.:3.000  
 Median :6.000   Median :6.000   Median :6.000   Median :6.000  
 Mean   :4.801   Mean   :4.781   Mean   :4.728   Mean   :4.787  
 3rd Qu.:6.000   3rd Qu.:6.000   3rd Qu.:6.000   3rd Qu.:6.000  
 Max.   :7.000   Max.   :7.000   Max.   :9.000   Max.   :7.000  
 NA's   :1       NA's   :4       NA's   :321     NA's   :722    
     ST5.1      
 Min.   :0.000  
 1st Qu.:3.000  
 Median :5.000  
 Mean   :4.651  
 3rd Qu.:6.000  
 Max.   :9.000  
 NA's   :857    </code></pre>
</div>
</div>
</section>
<section id="research-questions" class="level3">
<h3 class="anchored" data-anchor-id="research-questions">Research Questions</h3>
<section id="how-does-number-of-break-points-win-bpw-and-break-points-created-bpc-corralete-between-2-player-according-to-result" class="level4">
<h4 class="anchored" data-anchor-id="how-does-number-of-break-points-win-bpw-and-break-points-created-bpc-corralete-between-2-player-according-to-result">How does number of break points win (BPW) and break points created (BPC) corralete between 2 player according to result?</h4>
<p>As seen in the scatter plot, there is correlation between result and break points win. If player has more break points than opponent player, then, player that has more BPW and BPC probably win the match.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>BPW<span class="fl">.1</span>,<span class="at">y=</span>BPW<span class="fl">.2</span>,<span class="at">fill =</span> RESULT,<span class="at">colour=</span>RESULT))<span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()<span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter Plot of BPW.1 and BPW.2 by Result"</span>)<span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/EDA_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>BPC<span class="fl">.1</span>,<span class="at">y=</span>BPC<span class="fl">.2</span>,<span class="at">fill =</span> RESULT, <span class="at">colour =</span> RESULT))<span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter Plot of BPC.1 and BPC.2 by Result"</span>)<span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/EDA_1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hypothesis t-test can be conduct to show avarage BPC or BPW is greater for winning player.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normality Test Ekle</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>BPC.<span class="fl">1.</span>P1win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPC<span class="fl">.1</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>BPC.<span class="fl">2.</span>P1win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPC<span class="fl">.2</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform one-tailed t-test</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>t_test_BPC <span class="ot">&lt;-</span> <span class="fu">t.test</span>(BPC.<span class="fl">1.</span>P1win, BPC.<span class="fl">2.</span>P1win, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_BPC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  BPC.1.P1win and BPC.2.P1win
t = 16.758, df = 928, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 4.285722      Inf
sample estimates:
mean of x mean of y 
11.210753  6.458065 </code></pre>
</div>
</div>
<p>H0 is BPC.1 is equal or less than BPC.2 for RESULT is equals 1. H1 is BPC.1 is greater than BPC.2 for RESULT is equals 1. From t test confidence interval is 4.2857224, to infinite. So we can reject null hypothesis. Mean of BPC.1 is greater than mean of BPC.2 for RESULT equals 1. Similarly, mean of BPW.1 is greater than mean of BPW.2 for RESULT equals 1 according to t-test.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>BPC.<span class="fl">1.</span>P1win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPC<span class="fl">.1</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>BPC.<span class="fl">2.</span>P1win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPC<span class="fl">.2</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform one-tailed t-test</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>t_test_BPC <span class="ot">&lt;-</span> <span class="fu">t.test</span>(BPC.<span class="fl">1.</span>P1win, BPC.<span class="fl">2.</span>P1win, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_BPC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  BPC.1.P1win and BPC.2.P1win
t = 16.758, df = 928, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 4.285722      Inf
sample estimates:
mean of x mean of y 
11.210753  6.458065 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>BPW.<span class="fl">1.</span>P1win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPW<span class="fl">.1</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>BPW.<span class="fl">2.</span>P1win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPW<span class="fl">.2</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform one-tailed t-test</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>t_test_BPW <span class="ot">&lt;-</span> <span class="fu">t.test</span>(BPW.<span class="fl">1.</span>P1win, BPW.<span class="fl">2.</span>P1win, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_BPW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  BPW.1.P1win and BPW.2.P1win
t = 24.486, df = 928, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 2.752139      Inf
sample estimates:
mean of x mean of y 
 5.165591  2.215054 </code></pre>
</div>
</div>
<p>This situation is valid for RESULT equals 2 too.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>BPC.<span class="fl">2.</span>P2win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPC<span class="fl">.2</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>BPC.<span class="fl">1.</span>P2win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPC<span class="fl">.1</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform one-tailed t-test</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>t_test_BPC <span class="ot">&lt;-</span> <span class="fu">t.test</span>(BPC.<span class="fl">2.</span>P2win, BPC.<span class="fl">1.</span>P2win, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_BPC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  BPC.2.P2win and BPC.1.P2win
t = 14.982, df = 952, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 3.870193      Inf
sample estimates:
mean of x mean of y 
10.781971  6.433962 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>BPW.<span class="fl">2.</span>P2win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPW<span class="fl">.2</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>BPW.<span class="fl">1.</span>P2win <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RESULT<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BPW<span class="fl">.1</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform one-tailed t-test</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>t_test_BPW <span class="ot">&lt;-</span> <span class="fu">t.test</span>(BPW.<span class="fl">2.</span>P2win, BPW.<span class="fl">1.</span>P2win, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_BPW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  BPW.2.P2win and BPW.1.P2win
t = 24.587, df = 952, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 2.671964      Inf
sample estimates:
mean of x mean of y 
 5.062893  2.199161 </code></pre>
</div>
</div>
</section>
<section id="how-does-change-distribution-of-first-serve-percentage-fsp-and-first-serve-winning-fsw-for-winning-and-losing-player" class="level4">
<h4 class="anchored" data-anchor-id="how-does-change-distribution-of-first-serve-percentage-fsp-and-first-serve-winning-fsw-for-winning-and-losing-player">How does change distribution of first serve percentage (FSP) and First serve winning (FSW) for winning and losing player?</h4>
<p>As seen on the density plot, when player win the match, player’s first serve percentage is increase. Therefore, first serve percentage can be effective for winning the match. Similarly, box plot of FSP show that winner player has more FSW than loser one. So, having more FSW can effect the result.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>FSP<span class="fl">.1</span>,<span class="at">fill =</span> <span class="st">"blue"</span>))<span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>,<span class="at">fill =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>FSP<span class="fl">.2</span>,<span class="at">fill =</span> <span class="st">"red"</span>),<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">fill =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Density Plot of First Serve Percentage group by Result"</span>,<span class="at">x=</span><span class="st">"FSP.1(blue) and FSP.2(red)"</span>)<span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>RESULT)<span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/FSP_dens-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>FSW<span class="fl">.1</span>,<span class="at">fill =</span> RESULT))<span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>RESULT)<span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/FSP_dens-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>FSW<span class="fl">.2</span>,<span class="at">fill =</span> RESULT))<span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>RESULT)<span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/FSP_dens-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For confirmatory data analysis for this reasearch question, two paired t-test can be conduct too. As seen on the t-test result, mean of FSP.1 is changed significantly when result change.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>winning_player1 <span class="ot">&lt;-</span> GrandSlam[GrandSlam<span class="sc">$</span>RESULT <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>winning_player2 <span class="ot">&lt;-</span> GrandSlam[GrandSlam<span class="sc">$</span>RESULT <span class="sc">==</span> <span class="dv">2</span>, ]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct two-sample t-tests for FSP</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>fsp1_P1win <span class="ot">&lt;-</span> winning_player1<span class="sc">$</span>FSP<span class="fl">.1</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>fsp1_P2win <span class="ot">&lt;-</span> winning_player2<span class="sc">$</span>FSP<span class="fl">.1</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>t_test_fsp1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fsp1_P1win, fsp1_P2win,<span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Two-sample t-test for First Serve Percentage (FSP.1):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Two-sample t-test for First Serve Percentage (FSP.1):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_fsp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  fsp1_P1win and fsp1_P2win
t = 3.756, df = 941, p-value = 0.0001833
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.9190557 2.9303976
sample estimates:
mean of x mean of y 
 63.23226  61.30753 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct two-sample t-tests for FSW</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>fsw1_P1win <span class="ot">&lt;-</span> winning_player1<span class="sc">$</span>FSW<span class="fl">.1</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>fsw1_P2win <span class="ot">&lt;-</span> winning_player2<span class="sc">$</span>FSW<span class="fl">.1</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>t_test_fsw1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fsw1_P1win, fsw1_P2win,<span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Two-sample t-test for First Serve Winning (FSW.1):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Two-sample t-test for First Serve Winning (FSW.1):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_fsw1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  fsw1_P1win and fsw1_P2win
t = 3.6426, df = 941, p-value = 0.0002847
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 1.901268 6.342994
sample estimates:
mean of x mean of y 
 40.87527  36.75314 </code></pre>
</div>
</div>
<p>t-tests for FSP.2 and FSW.2 are like FSP.1 and FSP.2</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct two-sample t-tests for FSP</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>fsp2_P1win <span class="ot">&lt;-</span> winning_player1<span class="sc">$</span>FSP<span class="fl">.2</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>fsp2_P2win <span class="ot">&lt;-</span> winning_player2<span class="sc">$</span>FSP<span class="fl">.2</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>t_test_fsp2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fsp2_P1win, fsp2_P2win,<span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Two-sample t-test for First Serve Percentage (FSP.2):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Two-sample t-test for First Serve Percentage (FSP.2):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_fsp2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  fsp2_P1win and fsp2_P2win
t = -2.9031, df = 941, p-value = 0.003781
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.6430882 -0.5109677
sample estimates:
mean of x mean of y 
 61.16774  62.74477 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct two-sample t-tests for FSW</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>fsw2_P1win <span class="ot">&lt;-</span> winning_player1<span class="sc">$</span>FSW<span class="fl">.2</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>fsw2_P2win <span class="ot">&lt;-</span> winning_player2<span class="sc">$</span>FSW<span class="fl">.2</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>t_test_fsw2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fsw2_P1win, fsw2_P2win,<span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Two-sample t-test for First Serve Winning (FSW.2):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Two-sample t-test for First Serve Winning (FSW.2):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_fsw2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  fsw2_P1win and fsw2_P2win
t = -5.1976, df = 941, p-value = 2.476e-07
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -8.065531 -3.644237
sample estimates:
mean of x mean of y 
 35.72043  41.57531 </code></pre>
</div>
</div>
</section>
<section id="how-does-distribution-of-number-of-double-faul-dbf-and-aces-ace-change-for-different-tournaments-grouped-by-gender" class="level4">
<h4 class="anchored" data-anchor-id="how-does-distribution-of-number-of-double-faul-dbf-and-aces-ace-change-for-different-tournaments-grouped-by-gender">How does distribution of number of double faul (DBF) and aces (ACE) change for different tournaments grouped by gender?</h4>
<p>On this part, ACE variable is created by summing of ACE.1 and ACE.2. Similarly other variables are summing and total of player 1 and player 2 statistic variables are created. Aim of this research is investigating effect of different tournament on player performance. Each tournament have different surface type so this should be effect the match statistics. As seen in the boxplots, at French open tournament, players do less ace than other tounaments. Clay surface (French open surface) can lead to this, because clay surface slow down the ball. Also, in the boxplot of DBF, we can say that players do more double foul at the US and AUS open tournaments. Both tournaments has hard surfaces. Additionally, there is significant diffrence on male and female statistics for ACE, male can do more ACE than womwn according to this graph but number of sets are not same for male and female matches. Female matches are best of 3, but male matches are best of 5. So, this can be reason for that.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TPW=</span>TPW<span class="fl">.1</span><span class="sc">+</span>TPW<span class="fl">.2</span>,<span class="at">FSW=</span>FSW<span class="fl">.1</span><span class="sc">+</span>FSW<span class="fl">.2</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">SSW=</span>SSW<span class="fl">.1</span><span class="sc">+</span>SSW<span class="fl">.2</span>,<span class="at">ACE=</span>ACE<span class="fl">.1</span><span class="sc">+</span>ACE<span class="fl">.2</span>,<span class="at">DBF=</span>DBF<span class="fl">.1</span><span class="sc">+</span>DBF<span class="fl">.2</span>, <span class="at">WNR=</span>WNR<span class="fl">.1</span><span class="sc">+</span>WNR<span class="fl">.2</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">UFE=</span>UFE<span class="fl">.1</span><span class="sc">+</span>UFE<span class="fl">.2</span>, <span class="at">BPC =</span>BPC<span class="fl">.1</span><span class="sc">+</span>BPC<span class="fl">.2</span>, <span class="at">BPW=</span>BPW<span class="fl">.1</span><span class="sc">+</span>BPW<span class="fl">.2</span>, <span class="at">NPA=</span>NPA<span class="fl">.1</span><span class="sc">+</span>NPA<span class="fl">.2</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">NPW=</span>NPW<span class="fl">.1</span><span class="sc">+</span>NPW<span class="fl">.2</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(GrandSlam,<span class="fu">aes</span>(<span class="at">y=</span>ACE,<span class="at">fill=</span>TOURNAMENT))<span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>GENDER)<span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Boxplot of ACE for each tournement group by gender"</span>)<span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/EDA_3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(GrandSlam,<span class="fu">aes</span>(<span class="at">y=</span>DBF,<span class="at">fill=</span>TOURNAMENT))<span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>GENDER)<span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Boxplot of DBF for each tournement group by gender"</span>)<span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/EDA_3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With analysis of variance (ANOVA) for DBF and ACE, We can see there are significant difference between tournaments and gender for 0.05 significance level.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct ANOVA for DBF</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>anova_dbf <span class="ot">&lt;-</span> <span class="fu">aov</span>(DBF <span class="sc">~</span> TOURNAMENT <span class="sc">+</span> GENDER, <span class="at">data =</span> GrandSlam)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ANAVO of DBF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANAVO of DBF"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_dbf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
TOURNAMENT    3   1134   378.1   24.13 4.82e-15 ***
GENDER        1    310   310.0   19.78 9.72e-06 ***
Residuals   930  14572    15.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
8 observations deleted due to missingness</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct ANOVA for ACE</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>anova_ace <span class="ot">&lt;-</span> <span class="fu">aov</span>(ACE <span class="sc">~</span> TOURNAMENT <span class="sc">+</span> GENDER, <span class="at">data =</span> GrandSlam)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ANAVO of ACE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANAVO of ACE"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_ace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
TOURNAMENT    3   4114    1371    24.5 2.96e-15 ***
GENDER        1  36744   36744   656.5  &lt; 2e-16 ***
Residuals   916  51265      56                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
22 observations deleted due to missingness</code></pre>
</div>
</div>
</section>
<section id="are-there-differences-in-the-net-points-attempt-npa-and-net-points-win-npw-by-players-across-different-rounds-of-the-tournament-by-result" class="level4">
<h4 class="anchored" data-anchor-id="are-there-differences-in-the-net-points-attempt-npa-and-net-points-win-npw-by-players-across-different-rounds-of-the-tournament-by-result">Are there differences in the net points attempt (NPA) and net points win (NPW) by players across different rounds of the tournament by result?</h4>
<p>NPA and NPW has right skewed distribution for each round except 7th round, but in 7th round we have 8 observation so it can mislead the interpretation of this plot for 7th round. Therefore player NPA and NPW performances are similar for all rounds except 7th.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(GrandSlam,<span class="fu">aes</span>(<span class="at">y=</span>NPA,<span class="at">x=</span>ROUND,<span class="at">fill =</span> ROUND))<span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()<span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Violin Plot of NPA for each Round"</span>)<span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/EDA_4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(GrandSlam,<span class="fu">aes</span>(<span class="at">y=</span>NPW,<span class="at">x=</span>ROUND,<span class="at">fill =</span> ROUND))<span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()<span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Violin Plot of NPW for each Round"</span>)<span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/EDA_4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again by using ANOVA, we can show there is significant difference or not in NPW and NPA. As seen in ANOVA, for 0.05 significance level, there is no significant difference between NPA and NPW observations of different rounds.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct ANOVA for NPA</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>anova_NPA <span class="ot">&lt;-</span> <span class="fu">aov</span>(NPA <span class="sc">~</span> ROUND, <span class="at">data =</span> GrandSlam)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ANAVO of NPA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANAVO of NPA"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_NPA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
ROUND         6   5553   925.5   1.558  0.156
Residuals   852 506175   594.1               
84 observations deleted due to missingness</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct ANOVA for NPW</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>anova_NPW <span class="ot">&lt;-</span> <span class="fu">aov</span>(NPW <span class="sc">~</span> ROUND, <span class="at">data =</span> GrandSlam)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ANAVO of NPW"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANAVO of NPW"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_NPW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
ROUND         6   2253   375.6   1.453  0.191
Residuals   853 220433   258.4               
83 observations deleted due to missingness</code></pre>
</div>
</div>
</section>
<section id="is-there-any-correlation-between-number-of-break-points-created-bpc-total-points-win-tpw-and-first-serve-win-fsw" class="level4">
<h4 class="anchored" data-anchor-id="is-there-any-correlation-between-number-of-break-points-created-bpc-total-points-win-tpw-and-first-serve-win-fsw">Is there any correlation between number of break points created (BPC), total points win (TPW) and first serve win (FSW)?</h4>
<p>As seen on bubble plot, whwn BPC increase, TPW increase because when player break the opponent player serve, match can be extend. Also number of first serve win tend to increase when TPW and BPC increase.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(GrandSlam,<span class="fu">aes</span>(<span class="at">x=</span>TPW,<span class="at">y=</span>BPC,<span class="at">size =</span> FSW))<span class="sc">+</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatter plot of TPW vs BPC size by FSW"</span>)<span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/EDA_5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For CDA, we can check correlations between BPC, TPW and FSW. As seen on correlation plot,</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Pearson correlation coefficients</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(GrandSlam[,<span class="fu">c</span>(<span class="st">"BPC"</span>, <span class="st">"TPW"</span>, <span class="st">"FSW"</span>)],<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print correlation matrix</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/CDA_5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Also, checking p values of correlation test show that there is significant correlation between BPC, TPW and FSW for 0.05 significance level.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#correlation test</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(GrandSlam)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(GrandSlam<span class="sc">$</span>BPC, GrandSlam<span class="sc">$</span>TPW, <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">n =</span> n)<span class="sc">$</span>p.value</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values, <span class="fu">cor.test</span>(GrandSlam<span class="sc">$</span>BPC, GrandSlam<span class="sc">$</span>FSW, <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">n =</span> n)<span class="sc">$</span>p.value)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_values, <span class="fu">cor.test</span>(GrandSlam<span class="sc">$</span>TPW, GrandSlam<span class="sc">$</span>FSW, <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">n =</span> n)<span class="sc">$</span>p.value)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-values</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>cor_test <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"BPC_TPW"</span>,<span class="st">"BPC_FSW"</span>,<span class="st">"TPW_FSW"</span>)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">data.frame</span>(cor_test,p_values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  cor_test     p_values
1  BPC_TPW 4.643419e-76
2  BPC_FSW 1.610577e-49
3  TPW_FSW 0.000000e+00</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(TPW,FSW,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>        SSW,ACE,DBF, WNR,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>         UFE, BPC , BPW, NPA,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>         NPW))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="missing-observation-cleaning-imputation-and-data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="missing-observation-cleaning-imputation-and-data-manipulation">5. Missing Observation Cleaning, Imputation and Data Manipulation</h2>
<p>Firstly, we should find NA values. As we look at the number of NA observations of variables that include NA (below), we can see there are 5338 NA values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>na_columns <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(<span class="sc">~</span> <span class="fu">any</span>(<span class="fu">is.na</span>(.)))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(na_columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>FNL.1 FNL.2 ACE.1 DBF.1 WNR.1 UFE.1 BPC.1 BPW.1 NPA.1 NPW.1 TPW.1 ST1.1 ST2.1 
    1     1    22     8   126   126     1     1    84    83   312     1     4 
ST3.1 ST4.1 ST5.1 ACE.2 DBF.2 WNR.2 UFE.2 BPC.2 BPW.2 NPA.2 NPW.2 TPW.2 ST1.2 
  321   722   857    22     8   126   126     1     1    84    83   312     1 
ST2.2 ST3.2 ST4.2 ST5.2 
    4   321   722   857 </code></pre>
</div>
</div>
<p>For, FNL.1 and FNL.2 NA values are because of cancelled match. At the <a href="https://www.tennisabstract.com/cgi-bin/wplayer-classic.cgi?p=AlizeCornet&amp;f=A2014qqC2">link</a>, you can see this match (date 13.01.2014) is cancelled. This row is removed from data set.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(FNL<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   PLAYER1  PLAYER2 ROUND RESULT FNL.1 FNL.2 FSP.1 FSW.1 SSP.1 SSW.1 ACE.1
1 A.Cornet P.Hercog     1      2    NA    NA    75     3    25     1     1
  DBF.1 WNR.1 UFE.1 BPC.1 BPW.1 NPA.1 NPW.1 TPW.1 ST1.1 ST2.1 ST3.1 ST4.1 ST5.1
1    NA     2     0    NA    NA     1     1     5    NA    NA    NA    NA    NA
  FSP.2 FSW.2 SSP.2 SSW.2 ACE.2 DBF.2 WNR.2 UFE.2 BPC.2 BPW.2 NPA.2 NPW.2 TPW.2
1     0     0   100     1     0    NA     1     1    NA    NA     0     0     1
  ST1.2 ST2.2 ST3.2 ST4.2 ST5.2 TOURNAMENT GENDER
1    NA    NA    NA    NA    NA    AusOpen      F</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(FNL<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After removing the row that FNL values NA:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>na_columns <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(<span class="sc">~</span> <span class="fu">any</span>(<span class="fu">is.na</span>(.)))</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(na_columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ACE.1 DBF.1 WNR.1 UFE.1 NPA.1 NPW.1 TPW.1 ST2.1 ST3.1 ST4.1 ST5.1 ACE.2 DBF.2 
   22     7   126   126    84    83   312     3   320   721   856    22     7 
WNR.2 UFE.2 NPA.2 NPW.2 TPW.2 ST2.2 ST3.2 ST4.2 ST5.2 
  126   126    84    83   312     3   320   721   856 </code></pre>
</div>
</div>
<p>There is 22 NA in ACE.1 and ACE.2 columns at same observations, this is MCAR type missing observations, we can fill this values by median value of ACE. Median of ACE.1 and ACE.2 are 4 and 4.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>Med_ACE1 <span class="ot">&lt;-</span><span class="fu">median</span>(<span class="fu">na.omit</span>(GrandSlam<span class="sc">$</span>ACE<span class="fl">.1</span>))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>Med_ACE2 <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">na.omit</span>(GrandSlam<span class="sc">$</span>ACE<span class="fl">.2</span>))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>ACE<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>ACE<span class="fl">.1</span>),Med_ACE1,GrandSlam<span class="sc">$</span>ACE<span class="fl">.1</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>ACE<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>ACE<span class="fl">.2</span>),Med_ACE2,GrandSlam<span class="sc">$</span>ACE<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Similarly DBF NA values are MCAR, we can fill them by median value of DBF.1 and DBF.2. Median of DBF.1 and DBF.2 are 3 and 3.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>Med_DBF1 <span class="ot">&lt;-</span><span class="fu">median</span>(<span class="fu">na.omit</span>(GrandSlam<span class="sc">$</span>DBF<span class="fl">.1</span>))</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>Med_DBF2 <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">na.omit</span>(GrandSlam<span class="sc">$</span>DBF<span class="fl">.2</span>))</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>DBF<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>DBF<span class="fl">.1</span>),Med_DBF1,GrandSlam<span class="sc">$</span>DBF<span class="fl">.1</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>DBF<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>DBF<span class="fl">.2</span>),Med_DBF2,GrandSlam<span class="sc">$</span>DBF<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>UFE and WNR NA observations belong the same rows. Those NA values are in male US Open tournament. There is no UFE and WNR observation for male US open tournament. This Missing at Random mechanism. Rows that has NA UFE and WNR values removed from data set because this variables can be effective to result and removing the column may not be good idea.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(UFE<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(UFE<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After removing NA UFE and WNR values number of NA values are like below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>na_columns <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(<span class="sc">~</span> <span class="fu">any</span>(<span class="fu">is.na</span>(.)))</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(na_columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>NPA.1 NPW.1 TPW.1 ST2.1 ST3.1 ST4.1 ST5.1 NPA.2 NPW.2 TPW.2 ST2.2 ST3.2 ST4.2 
   46    45   312     3   319   662   755    46    45   312     3   319   662 
ST5.2 
  755 </code></pre>
</div>
</div>
<p>46 and 45 NA values for NPA and NPW are MCAR case because there is no any . Those NA values can be filled by median of NPA and NPW values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>Med_NPA1 <span class="ot">&lt;-</span><span class="fu">median</span>(<span class="fu">na.omit</span>(GrandSlam<span class="sc">$</span>NPA<span class="fl">.1</span>))</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>Med_NPA2 <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">na.omit</span>(GrandSlam<span class="sc">$</span>NPA<span class="fl">.2</span>))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>NPA<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>NPA<span class="fl">.1</span>),Med_NPA1,GrandSlam<span class="sc">$</span>NPA<span class="fl">.1</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>NPA<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>NPA<span class="fl">.2</span>),Med_NPA2,GrandSlam<span class="sc">$</span>NPA<span class="fl">.2</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>Med_NPW1 <span class="ot">&lt;-</span><span class="fu">median</span>(<span class="fu">na.omit</span>(GrandSlam<span class="sc">$</span>NPW<span class="fl">.1</span>))</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>Med_NPW2 <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">na.omit</span>(GrandSlam<span class="sc">$</span>NPW<span class="fl">.2</span>))</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>NPW<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>NPW<span class="fl">.1</span>),Med_NPW1,GrandSlam<span class="sc">$</span>NPW<span class="fl">.1</span>)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>NPW<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(GrandSlam<span class="sc">$</span>NPW<span class="fl">.2</span>),Med_NPW2,GrandSlam<span class="sc">$</span>NPW<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There are 312 NA values for total points win (TPW) observations. As seen in the bar graphs, when player’s TPW is greater than opponent player, this player wins the match, it is almost like result. Therefore TPW is totaly dependent to result. TPW variable should be removed from data set. Similarly FNL is directly give the result, so we should remove FNL variables too. For alternative modelling of TPW, rows that have NA TPW values are removed and regression data created separately.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TPW<span class="fl">.2</span><span class="sc">&gt;</span>TPW<span class="fl">.1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>RESULT,<span class="at">fill =</span> RESULT))<span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Results when TPW.2 greater than TPW.1"</span>)<span class="sc">+</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/NA_10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TPW<span class="fl">.1</span><span class="sc">&gt;</span>TPW<span class="fl">.2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>RESULT,<span class="at">fill =</span> RESULT))<span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Results when TPW.1 greater than TPW.2"</span>)<span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/NA_10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">## TPW tahmini için regression datası. TPW NA olan rowlar çıkarıldı.</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg <span class="ot">&lt;-</span> GrandSlam<span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(TPW<span class="fl">.1</span>))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg <span class="ot">&lt;-</span> GrandSlam_Reg<span class="sc">%&gt;%</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(FNL<span class="fl">.1</span>,FNL<span class="fl">.2</span>,RESULT))</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(TPW<span class="fl">.1</span>,TPW<span class="fl">.2</span>,FNL<span class="fl">.1</span>,FNL<span class="fl">.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After TPW remove from data set, number of NA values are like below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>na_columns <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(<span class="sc">~</span> <span class="fu">any</span>(<span class="fu">is.na</span>(.)))</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(na_columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ST2.1 ST3.1 ST4.1 ST5.1 ST2.2 ST3.2 ST4.2 ST5.2 
    3   319   662   755     3   319   662   755 </code></pre>
</div>
</div>
<p>Set scores (ST) are similar to TPW, if we know 2 players set score, match result can be known. Therefore ST values should be removed from data set. However, number of total game (TG) variable can be created from sum of all ST values for each row. Number of total game can be use for standardize the match statistics. For example we can find avarage number of ace for 1 game from ACE.1 over number of total game. So, after created TG, all ST values can be removed. FSW, SSW, ACE, DBF, WNR, UFE, BPC, BPW, NPA, NPW variables are divided to TG to standartize match statistics.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>GrandSlam<span class="sc">$</span>TG <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(GrandSlam[, <span class="fu">c</span>(<span class="st">"ST1.1"</span>, <span class="st">"ST2.1"</span>, <span class="st">"ST3.1"</span>, <span class="st">"ST4.1"</span>,<span class="st">"ST5.1"</span>,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"ST1.2"</span>, <span class="st">"ST2.2"</span>, <span class="st">"ST3.2"</span>, <span class="st">"ST4.2"</span>,<span class="st">"ST5.2"</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Rgression</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg<span class="sc">$</span>TG <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(GrandSlam_Reg[, <span class="fu">c</span>(<span class="st">"ST1.1"</span>, <span class="st">"ST2.1"</span>, <span class="st">"ST3.1"</span>, <span class="st">"ST4.1"</span>,<span class="st">"ST5.1"</span>,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"ST1.2"</span>, <span class="st">"ST2.2"</span>, <span class="st">"ST3.2"</span>, <span class="st">"ST4.2"</span>,<span class="st">"ST5.2"</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg <span class="ot">&lt;-</span> GrandSlam_Reg <span class="sc">%&gt;%</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(ST1<span class="fl">.1</span>,ST2<span class="fl">.1</span>,ST3<span class="fl">.1</span>,ST4<span class="fl">.1</span>,ST5<span class="fl">.1</span>,ST1<span class="fl">.2</span>,ST2<span class="fl">.2</span>,ST3<span class="fl">.2</span>,ST4<span class="fl">.2</span>,ST5<span class="fl">.2</span>))</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg <span class="ot">&lt;-</span> GrandSlam_Reg <span class="sc">%&gt;%</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FSW.1 =</span> <span class="fu">as.numeric</span>(FSW<span class="fl">.1</span><span class="sc">/</span>TG), <span class="at">FSW.2 =</span> <span class="fu">as.numeric</span>(FSW<span class="fl">.2</span><span class="sc">/</span>TG), <span class="at">SSW.1 =</span> <span class="fu">as.numeric</span>(SSW<span class="fl">.1</span><span class="sc">/</span>TG),</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">SSW.2=</span><span class="fu">as.numeric</span>(SSW<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">ACE.1 =</span> <span class="fu">as.numeric</span>(ACE<span class="fl">.1</span><span class="sc">/</span>TG), <span class="at">ACE.2 =</span> <span class="fu">as.numeric</span>(ACE<span class="fl">.2</span><span class="sc">/</span>TG),</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">DBF.1=</span><span class="fu">as.numeric</span>(DBF<span class="fl">.1</span><span class="sc">/</span>TG),<span class="at">DBF.2=</span><span class="fu">as.numeric</span>(DBF<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">WNR.1=</span><span class="fu">as.numeric</span>(WNR<span class="fl">.1</span><span class="sc">/</span>TG),</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">WNR.2=</span><span class="fu">as.numeric</span>(WNR<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">UFE.1=</span><span class="fu">as.numeric</span>(UFE<span class="fl">.1</span><span class="sc">/</span>TG),<span class="at">BPC.1=</span><span class="fu">as.numeric</span>(BPC<span class="fl">.1</span><span class="sc">/</span>TG),</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">BPC.2=</span><span class="fu">as.numeric</span>(BPC<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">BPW.1=</span><span class="fu">as.numeric</span>(BPW<span class="fl">.1</span><span class="sc">/</span>TG),<span class="at">BPW.2=</span><span class="fu">as.numeric</span>(BPW<span class="fl">.2</span><span class="sc">/</span>TG),</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">NPA.1=</span><span class="fu">as.numeric</span>(NPA<span class="fl">.1</span><span class="sc">/</span>TG),<span class="at">NPA.2=</span><span class="fu">as.numeric</span>(NPA<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">NPW.1=</span><span class="fu">as.numeric</span>(NPW<span class="fl">.1</span><span class="sc">/</span>TG),</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">NPW.2=</span><span class="fu">as.numeric</span>(NPW<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">TPW.1=</span>TPW<span class="fl">.1</span><span class="sc">/</span>TG,<span class="at">TPW.2=</span>TPW<span class="fl">.2</span><span class="sc">/</span>TG)</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="do">######</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(ST1<span class="fl">.1</span>,ST2<span class="fl">.1</span>,ST3<span class="fl">.1</span>,ST4<span class="fl">.1</span>,ST5<span class="fl">.1</span>,ST1<span class="fl">.2</span>,ST2<span class="fl">.2</span>,ST3<span class="fl">.2</span>,ST4<span class="fl">.2</span>,ST5<span class="fl">.2</span>))</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FSW.1 =</span> <span class="fu">as.numeric</span>(FSW<span class="fl">.1</span><span class="sc">/</span>TG), <span class="at">FSW.2 =</span> <span class="fu">as.numeric</span>(FSW<span class="fl">.2</span><span class="sc">/</span>TG), <span class="at">SSW.1 =</span> <span class="fu">as.numeric</span>(SSW<span class="fl">.1</span><span class="sc">/</span>TG),</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">SSW.2=</span><span class="fu">as.numeric</span>(SSW<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">ACE.1 =</span> <span class="fu">as.numeric</span>(ACE<span class="fl">.1</span><span class="sc">/</span>TG), <span class="at">ACE.2 =</span> <span class="fu">as.numeric</span>(ACE<span class="fl">.2</span><span class="sc">/</span>TG),</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">DBF.1=</span><span class="fu">as.numeric</span>(DBF<span class="fl">.1</span><span class="sc">/</span>TG),<span class="at">DBF.2=</span><span class="fu">as.numeric</span>(DBF<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">WNR.1=</span><span class="fu">as.numeric</span>(WNR<span class="fl">.1</span><span class="sc">/</span>TG),</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">WNR.2=</span><span class="fu">as.numeric</span>(WNR<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">UFE.1=</span><span class="fu">as.numeric</span>(UFE<span class="fl">.1</span><span class="sc">/</span>TG),<span class="at">BPC.1=</span><span class="fu">as.numeric</span>(BPC<span class="fl">.1</span><span class="sc">/</span>TG),</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">BPC.2=</span><span class="fu">as.numeric</span>(BPC<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">BPW.1=</span><span class="fu">as.numeric</span>(BPW<span class="fl">.1</span><span class="sc">/</span>TG),<span class="at">BPW.2=</span><span class="fu">as.numeric</span>(BPW<span class="fl">.2</span><span class="sc">/</span>TG),</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">NPA.1=</span><span class="fu">as.numeric</span>(NPA<span class="fl">.1</span><span class="sc">/</span>TG),<span class="at">NPA.2=</span><span class="fu">as.numeric</span>(NPA<span class="fl">.2</span><span class="sc">/</span>TG),<span class="at">NPW.1=</span><span class="fu">as.numeric</span>(NPW<span class="fl">.1</span><span class="sc">/</span>TG),</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">NPW.2=</span><span class="fu">as.numeric</span>(NPW<span class="fl">.2</span><span class="sc">/</span>TG))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There is 350 unique player on this data set. So using players as predictor is not good idea because there are 350 levels, this is not convenient for modeling. Also, our aim in this project is predict result by using player performance like ACE, BPC etc., and show the most important statistics. Because of that PLAYER1 and PLAYER2 columns are removed from data set.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>GrandSlam <span class="ot">&lt;-</span> GrandSlam <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PLAYER1,PLAYER2,TG))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Regression</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg <span class="ot">&lt;-</span> GrandSlam_Reg <span class="sc">%&gt;%</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PLAYER1,PLAYER2,TG))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After missing data cleaning and imputation, we have 816 observations and 28 variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GrandSlam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> ROUND   RESULT      FSP.1          FSW.1            SSP.1      
 1:409   1:406   Min.   :40.0   Min.   :0.5294   Min.   :14.00  
 2:197   2:410   1st Qu.:57.0   1st Qu.:1.1780   1st Qu.:32.00  
 3:107           Median :63.0   Median :1.3586   Median :37.00  
 4: 55           Mean   :62.8   Mean   :1.3451   Mean   :37.25  
 5: 27           3rd Qu.:68.0   3rd Qu.:1.5241   3rd Qu.:43.00  
 6: 14           Max.   :86.0   Max.   :2.6000   Max.   :60.00  
 7:  7                                                          
     SSW.1             ACE.1             DBF.1             WNR.1       
 Min.   :0.07692   Min.   :0.00000   Min.   :0.00000   Min.   :0.0000  
 1st Qu.:0.44444   1st Qu.:0.06897   1st Qu.:0.06061   1st Qu.:0.7222  
 Median :0.56667   Median :0.15895   Median :0.11652   Median :1.0000  
 Mean   :0.56579   Mean   :0.19456   Mean   :0.13405   Mean   :1.0019  
 3rd Qu.:0.68750   3rd Qu.:0.26923   3rd Qu.:0.18750   3rd Qu.:1.2632  
 Max.   :1.40000   Max.   :1.12000   Max.   :0.66667   Max.   :3.0769  
                                                                       
     UFE.1           BPC.1            BPW.1            NPA.1        
 Min.   :0.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.03704  
 1st Qu.:0.717   1st Qu.:0.1765   1st Qu.:0.0625   1st Qu.:0.42720  
 Median :1.000   Median :0.3125   Median :0.1290   Median :0.63830  
 Mean   :1.042   Mean   :0.3331   Mean   :0.1438   Mean   :0.67743  
 3rd Qu.:1.349   3rd Qu.:0.4600   3rd Qu.:0.2105   3rd Qu.:0.85000  
 Max.   :3.167   Max.   :1.2667   Max.   :0.5000   Max.   :2.12195  
                                                                    
     NPW.1            FSP.2           FSW.2            SSP.2      
 Min.   :0.0000   Min.   :39.00   Min.   :0.4286   Min.   : 7.00  
 1st Qu.:0.2639   1st Qu.:57.00   1st Qu.:1.1761   1st Qu.:32.00  
 Median :0.4074   Median :62.00   Median :1.3438   Median :38.00  
 Mean   :0.4410   Mean   :62.51   Mean   :1.3486   Mean   :37.51  
 3rd Qu.:0.5625   3rd Qu.:68.00   3rd Qu.:1.5034   3rd Qu.:43.00  
 Max.   :4.1333   Max.   :93.00   Max.   :2.6512   Max.   :61.00  
                                                                  
     SSW.2            ACE.2             DBF.2            WNR.2      
 Min.   :0.0625   Min.   :0.00000   Min.   :0.0000   Min.   :0.000  
 1st Qu.:0.4515   1st Qu.:0.05882   1st Qu.:0.0625   1st Qu.:0.750  
 Median :0.5769   Median :0.15385   Median :0.1195   Median :1.000  
 Mean   :0.5758   Mean   :0.18132   Mean   :0.1427   Mean   :1.007  
 3rd Qu.:0.6875   3rd Qu.:0.27273   3rd Qu.:0.2000   3rd Qu.:1.263  
 Max.   :1.4000   Max.   :0.93750   Max.   :0.7692   Max.   :2.455  
                                                                    
     UFE.2           BPC.2            BPW.2            NPA.2       
 Min.   : 0.00   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:16.00   1st Qu.:0.1852   1st Qu.:0.0625   1st Qu.:0.4118  
 Median :26.00   Median :0.3093   Median :0.1263   Median :0.6364  
 Mean   :27.71   Mean   :0.3292   Mean   :0.1454   Mean   :0.6733  
 3rd Qu.:37.00   3rd Qu.:0.4487   3rd Qu.:0.2105   3rd Qu.:0.8800  
 Max.   :96.00   Max.   :1.1667   Max.   :0.5385   Max.   :2.2903  
                                                                   
     NPW.2             TOURNAMENT  GENDER 
 Min.   :0.0000   AusOpen   :252   F:451  
 1st Qu.:0.2632   FrenchOpen:252   M:365  
 Median :0.4019   USopen    : 76          
 Mean   :0.4438   Wimbledon :236          
 3rd Qu.:0.5882                           
 Max.   :2.2667                           
                                          </code></pre>
</div>
</div>
<p>Also, another grandslam data formed for TPW regression models separetely. This will discuss in regression modeling part.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg <span class="ot">&lt;-</span> GrandSlam_Reg <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(NPW<span class="fl">.1</span>,NPW<span class="fl">.2</span>,BPW<span class="fl">.1</span>,BPW<span class="fl">.2</span>, SSP<span class="fl">.1</span>, SSP<span class="fl">.2</span>, TOURNAMENT,ROUND,GENDER))</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(GrandSlam_Reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FSP.1" "FSW.1" "SSW.1" "ACE.1" "DBF.1" "WNR.1" "UFE.1" "BPC.1" "NPA.1"
[10] "TPW.1" "FSP.2" "FSW.2" "SSW.2" "ACE.2" "DBF.2" "WNR.2" "UFE.2" "BPC.2"
[19] "NPA.2" "TPW.2"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg_1 <span class="ot">&lt;-</span> GrandSlam_Reg <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"FSP.1"</span>, <span class="st">"FSW.1"</span>, <span class="st">"SSW.1"</span> ,<span class="st">"ACE.1"</span> ,<span class="st">"DBF.1"</span>, <span class="st">"WNR.1"</span>, <span class="st">"UFE.1"</span>, <span class="st">"BPC.1"</span> ,<span class="st">"NPA.1"</span> ,<span class="st">"TPW.1"</span>))</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg_2 <span class="ot">&lt;-</span> GrandSlam_Reg <span class="sc">%&gt;%</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"FSP.2"</span>, <span class="st">"FSW.2"</span>, <span class="st">"SSW.2"</span> ,<span class="st">"ACE.2"</span> ,<span class="st">"DBF.2"</span>, <span class="st">"WNR.2"</span>, <span class="st">"UFE.2"</span>, <span class="st">"BPC.2"</span> ,<span class="st">"NPA.2"</span> ,<span class="st">"TPW.2"</span>))</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(GrandSlam_Reg_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"FSP"</span>, <span class="st">"FSW"</span>, <span class="st">"SSW"</span> ,<span class="st">"ACE"</span> ,<span class="st">"DBF"</span>, <span class="st">"WNR"</span>, <span class="st">"UFE"</span>, <span class="st">"BPC"</span> ,<span class="st">"NPA"</span> ,<span class="st">"TPW"</span>)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(GrandSlam_Reg_2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"FSP"</span>, <span class="st">"FSW"</span>, <span class="st">"SSW"</span> ,<span class="st">"ACE"</span> ,<span class="st">"DBF"</span>, <span class="st">"WNR"</span>, <span class="st">"UFE"</span>, <span class="st">"BPC"</span> ,<span class="st">"NPA"</span> ,<span class="st">"TPW"</span>)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg_final <span class="ot">&lt;-</span> <span class="fu">rbind</span>(GrandSlam_Reg_1,GrandSlam_Reg_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="classification-statistical-modelling" class="level2">
<h2 class="anchored" data-anchor-id="classification-statistical-modelling">Classification Statistical Modelling</h2>
<section id="train-test-data-set-preparation" class="level3">
<h3 class="anchored" data-anchor-id="train-test-data-set-preparation">Train-Test Data Set Preparation</h3>
<p>GrandSlam data set splited by 20% test and 80% training by random selection. Before modelling, numeric variables in the train and test data set should be scaled. Firstly, train set is scaled and then, by using train set mean and standart deviation test set should be scaled too. Test and train sets are scaled after splitting, because, test observations should not be effect anything on the train data set in order to maintain integrity of model evaluation. After scale the train data set summary is like below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creating test training data by considcering distribution of Result</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>GrandSlam_idx <span class="ot">=</span> <span class="fu">createDataPartition</span>(GrandSlam<span class="sc">$</span>RESULT, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>GrandSlam_train <span class="ot">=</span> GrandSlam[GrandSlam_idx, ]</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>GrandSlam_test <span class="ot">=</span> GrandSlam[<span class="sc">-</span>GrandSlam_idx, ]</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>train_numeric <span class="ot">&lt;-</span> GrandSlam_train <span class="sc">%&gt;%</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>train_other <span class="ot">&lt;-</span> GrandSlam_train <span class="sc">%&gt;%</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(ROUND,RESULT,TOURNAMENT,GENDER))</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>test_numeric <span class="ot">&lt;-</span> GrandSlam_test <span class="sc">%&gt;%</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric)</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>test_other <span class="ot">&lt;-</span> GrandSlam_test <span class="sc">%&gt;%</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(ROUND,RESULT,TOURNAMENT,GENDER))</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the training predictors</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>train_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(train_numeric, <span class="dv">2</span>, mean)</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>train_sd <span class="ot">&lt;-</span> <span class="fu">apply</span>(train_numeric, <span class="dv">2</span>, sd)</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>train_numeric_standardized <span class="ot">&lt;-</span> <span class="fu">scale</span>(train_numeric, <span class="at">center =</span> train_mean, <span class="at">scale =</span> train_sd)</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the test predictors using training mean and sd</span></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>test_numeric_standardized <span class="ot">&lt;-</span> <span class="fu">scale</span>(test_numeric, <span class="at">center =</span> train_mean, <span class="at">scale =</span> train_sd)</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine standardized predictors with the response variable</span></span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>GrandSlam_trn_std <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(train_numeric_standardized, train_other)</span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>GrandSlam_tst_std <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(test_numeric_standardized, test_other)</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GrandSlam_trn_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FSP.1              FSW.1              SSP.1              SSW.1          
 Min.   :-2.87933   Min.   :-3.08076   Min.   :-2.92972   Min.   :-2.743124  
 1st Qu.:-0.60947   1st Qu.:-0.60943   1st Qu.:-0.65942   1st Qu.:-0.665252  
 Median : 0.02105   Median : 0.06713   Median :-0.02878   Median : 0.003905  
 Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.000000  
 3rd Qu.: 0.65157   3rd Qu.: 0.65433   3rd Qu.: 0.72799   3rd Qu.: 0.663223  
 Max.   : 2.92143   Max.   : 4.37537   Max.   : 2.87216   Max.   : 4.678169  
                                                                             
     ACE.1             DBF.1             WNR.1              UFE.1         
 Min.   :-1.1991   Min.   :-1.3066   Min.   :-2.32228   Min.   :-2.16166  
 1st Qu.:-0.7660   1st Qu.:-0.7217   1st Qu.:-0.65354   1st Qu.:-0.64504  
 Median :-0.2212   Median :-0.1703   Median :-0.01172   Median :-0.06515  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.00000  
 3rd Qu.: 0.4544   3rd Qu.: 0.4780   3rd Qu.: 0.59632   3rd Qu.: 0.59690  
 Max.   : 5.5913   Max.   : 5.3218   Max.   : 4.78713   Max.   : 4.47727  
                                                                          
     BPC.1             BPW.1             NPA.1             NPW.1        
 Min.   :-1.5978   Min.   :-1.3500   Min.   :-1.8350   Min.   :-1.8629  
 1st Qu.:-0.7714   1st Qu.:-0.7784   1st Qu.:-0.7188   1st Qu.:-0.7338  
 Median :-0.1017   Median :-0.1410   Median :-0.1192   Median :-0.1108  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.: 0.6171   3rd Qu.: 0.6011   3rd Qu.: 0.4827   3rd Qu.: 0.5403  
 Max.   : 4.5084   Max.   : 3.3652   Max.   : 4.1089   Max.   : 3.6415  
                                                                        
     FSP.2              FSW.2              SSP.2              SSW.2         
 Min.   :-2.90723   Min.   :-3.05657   Min.   :-3.70962   Min.   :-2.77741  
 1st Qu.:-0.69991   1st Qu.:-0.61883   1st Qu.:-0.65121   1st Qu.:-0.65742  
 Median :-0.08676   Median :-0.01924   Median : 0.08281   Median : 0.01529  
 Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.00000  
 3rd Qu.: 0.64901   3rd Qu.: 0.59574   3rd Qu.: 0.69449   3rd Qu.: 0.60229  
 Max.   : 3.71474   Max.   : 4.69118   Max.   : 2.89655   Max.   : 4.45515  
                                                                            
     ACE.2             DBF.2             WNR.2              UFE.2        
 Min.   :-1.1672   Min.   :-1.2677   Min.   :-2.51166   Min.   :-1.8093  
 1st Qu.:-0.7850   1st Qu.:-0.7057   1st Qu.:-0.61799   1st Qu.:-0.7657  
 Median :-0.1676   Median :-0.2099   Median :-0.01546   Median :-0.1135  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  
 3rd Qu.: 0.6049   3rd Qu.: 0.4614   3rd Qu.: 0.60858   3rd Qu.: 0.6040  
 Max.   : 4.9245   Max.   : 5.6488   Max.   : 3.61536   Max.   : 4.4521  
                                                                         
     BPC.2             BPW.2             NPA.2             NPW.2        
 Min.   :-1.6976   Min.   :-1.3429   Min.   :-1.8912   Min.   :-1.8309  
 1st Qu.:-0.7324   1st Qu.:-0.7570   1st Qu.:-0.7206   1st Qu.:-0.7276  
 Median :-0.1112   Median :-0.1712   Median :-0.1118   Median :-0.1677  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.: 0.6480   3rd Qu.: 0.5870   3rd Qu.: 0.5555   3rd Qu.: 0.5990  
 Max.   : 3.8623   Max.   : 3.3439   Max.   : 4.4768   Max.   : 4.4901  
                                                                        
 ROUND   RESULT       TOURNAMENT  GENDER 
 1:326   1:325   AusOpen   :201   F:358  
 2:155   2:328   FrenchOpen:197   M:295  
 3: 80           USopen    : 64          
 4: 49           Wimbledon :191          
 5: 24                                   
 6: 12                                   
 7:  7                                   </code></pre>
</div>
</div>
</section>
<section id="logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h3>
<p>Logistic regression is used to predict the RESULT of the tennis matches on this project. As a cross validation method, k-fold cv is used for k equals 10. This cv is made by using “caret” package in r. Our dependent variable should be binary. So, RESULT is binary with 1 or 2.</p>
<p>Independence: predictors should be independent from eachother, We can check that by checking correlation between numeric predictors. As seen on the correlation plot. There are high correlation between NPW and NPA, BPC and BPW, FSP and SSP. So, NPW, BPW and SSP variables are removed from data set.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Pearson correlation coefficients</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>numeric_var <span class="ot">&lt;-</span> GrandSlam_trn_std <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(NPW<span class="fl">.1</span>,NPA<span class="fl">.1</span>,NPW<span class="fl">.2</span>,NPA<span class="fl">.2</span>,BPC<span class="fl">.1</span> ,BPW<span class="fl">.1</span>,BPC<span class="fl">.2</span> ,BPW<span class="fl">.2</span>,FSP<span class="fl">.1</span>, SSP<span class="fl">.1</span>,FSP<span class="fl">.2</span>, SSP<span class="fl">.2</span>))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(numeric_var,<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print correlation matrix</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/corr-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>GrandSlam_trn_std <span class="ot">&lt;-</span> GrandSlam_trn_std <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(NPW<span class="fl">.1</span>,NPW<span class="fl">.2</span>,BPW<span class="fl">.1</span>,BPW<span class="fl">.2</span>, SSP<span class="fl">.1</span>, SSP<span class="fl">.2</span>))</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>GrandSlam_tst_std <span class="ot">&lt;-</span> GrandSlam_tst_std <span class="sc">%&gt;%</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(NPW<span class="fl">.1</span>,NPW<span class="fl">.2</span>,BPW<span class="fl">.1</span>,BPW<span class="fl">.2</span>, SSP<span class="fl">.1</span>, SSP<span class="fl">.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, logistic regression can be applied. Logistic regression find that probability of result equal to 2.</p>
<p>FSW, SSW and BPC statistics are more effective than other to predict winner. Also, p-values show that FSW, SSW and BPC are highly significant predictors. FSW and BPC influence can be seen in EDA part too. That shows that, player can practice more serve shoots to increase the win rate. Also, model indicate that breaking the opponent serve with fast shoots is really effective on win rate.</p>
<p>On the other hand, WNR and UFE seems marginally significant and can be effective to predict result.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#10 k fold cv.</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span> ,<span class="at">savePredictions =</span> <span class="st">"final"</span>)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>log_model <span class="ot">&lt;-</span> <span class="fu">train</span>(RESULT <span class="sc">~</span> ., <span class="at">data =</span> GrandSlam_trn_std, <span class="at">method =</span> <span class="st">"glm"</span>,<span class="at">family=</span>binomial,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trControl =</span> train_control)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>log_model_1<span class="ot">&lt;-</span>log_model<span class="sc">$</span>finalModel</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           0.24603    0.60894   0.404   0.6862    
FSP.1                -0.61302    0.47689  -1.285   0.1986    
FSW.1                -2.97388    0.45509  -6.535 6.37e-11 ***
SSW.1                -2.00521    0.45368  -4.420 9.87e-06 ***
ACE.1                -0.24587    0.36663  -0.671   0.5025    
DBF.1                 0.23487    0.29671   0.792   0.4286    
WNR.1                -0.71190    0.38539  -1.847   0.0647 .  
UFE.1                 0.54718    0.38316   1.428   0.1533    
BPC.1                -3.12437    0.43752  -7.141 9.26e-13 ***
NPA.1                 0.23507    0.26432   0.889   0.3738    
FSP.2                -0.06253    0.44887  -0.139   0.8892    
FSW.2                 3.57826    0.53612   6.674 2.48e-11 ***
SSW.2                 1.99227    0.42944   4.639 3.50e-06 ***
ACE.2                 0.17347    0.31286   0.554   0.5793    
DBF.2                -0.31710    0.30401  -1.043   0.2969    
WNR.2                 0.56827    0.35892   1.583   0.1134    
UFE.2                -0.43340    0.29456  -1.471   0.1412    
BPC.2                 2.07478    0.42251   4.911 9.08e-07 ***
NPA.2                -0.06337    0.27882  -0.227   0.8202    
ROUND2               -0.77227    0.50072  -1.542   0.1230    
ROUND3                0.01176    0.64574   0.018   0.9855    
ROUND4               -0.44164    0.85519  -0.516   0.6056    
ROUND5               -0.37129    1.21399  -0.306   0.7597    
ROUND6                0.38407    2.46724   0.156   0.8763    
ROUND7                0.04242   11.46658   0.004   0.9970    
TOURNAMENTFrenchOpen -0.11085    0.57806  -0.192   0.8479    
TOURNAMENTUSopen      0.50268    0.89107   0.564   0.5727    
TOURNAMENTWimbledon  -0.13611    0.58962  -0.231   0.8174    
GENDERM               0.17264    0.76705   0.225   0.8219    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 905.24  on 652  degrees of freedom
Residual deviance: 176.89  on 624  degrees of freedom
AIC: 234.89

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Other predictors are not significant, so we can remake the logistic regression with significant predictors. Now all predictors are significant to predict RESULT. FSW is the most effective statistics to win the match. When FSW.1 change one unit, the log odds of the outcome decrease 3.11214 units. This means there is negative relationship between probability of result 2 and FSW.1. Similarly SSW.1, BPC.1, WNR.1 and UFE.2 has negative effect to result equal 2. As expected, FSW.2, SSW.2, BPC.2, WNR.2 and UFE.1 has positive relationship.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>log_model <span class="ot">&lt;-</span> <span class="fu">train</span>(RESULT <span class="sc">~</span> FSW<span class="fl">.1</span><span class="sc">+</span>SSW<span class="fl">.1</span><span class="sc">+</span>BPC<span class="fl">.1</span><span class="sc">+</span>WNR<span class="fl">.1</span><span class="sc">+</span>UFE<span class="fl">.1</span><span class="sc">+</span>FSW<span class="fl">.2</span><span class="sc">+</span>SSW<span class="fl">.2</span><span class="sc">+</span>BPC<span class="fl">.2</span><span class="sc">+</span>WNR<span class="fl">.2</span><span class="sc">+</span>UFE<span class="fl">.2</span>, <span class="at">data =</span> GrandSlam_trn_std, <span class="at">method =</span> <span class="st">"glm"</span>,<span class="at">family=</span>binomial,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trControl =</span> train_control)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>log_model1<span class="ot">&lt;-</span> log_model<span class="sc">$</span>finalModel</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.05006    0.21678   0.231   0.8174    
FSW.1       -3.11214    0.40638  -7.658 1.89e-14 ***
SSW.1       -1.51174    0.25946  -5.826 5.66e-09 ***
BPC.1       -3.13892    0.38135  -8.231  &lt; 2e-16 ***
WNR.1       -0.80937    0.31209  -2.593   0.0095 ** 
UFE.1        0.66587    0.28818   2.311   0.0209 *  
FSW.2        3.50518    0.43749   8.012 1.13e-15 ***
SSW.2        1.91402    0.31193   6.136 8.46e-10 ***
BPC.2        2.02562    0.38736   5.229 1.70e-07 ***
WNR.2        0.43048    0.27865   1.545   0.1224    
UFE.2       -0.45971    0.21044  -2.185   0.0289 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 905.24  on 652  degrees of freedom
Residual deviance: 186.55  on 642  degrees of freedom
AIC: 208.55

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>You can find vif matrix of logistic regression at appendix b, There are no higher than 10 vif value. So, there is no highly correlated variables that lead multicollinearity. There is confusion matrix for test data and performance statistics for test and train data. Accuracy is 0.9 for test data which is acceptable and effective result. However, train data has 0.95 accuracy because logistic regression model made by train data. So, there are some overfitting. Other performance parameters are good as well. Other train data performance parameter are greater than test data too.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(log_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   FSW.1    SSW.1    BPC.1    WNR.1    UFE.1    FSW.2    SSW.2    BPC.2 
3.777800 2.100312 2.347107 2.301489 2.150929 4.253240 2.020017 2.355282 
   WNR.2    UFE.2 
1.777138 1.663171 </code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/log_performance-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Test data Performance of Logistic Regression</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.9263804</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">0.9259259</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">0.9259259</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">0.9259259</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Train data Performance of Logistic Regression</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.9479326</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">0.9532710</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">0.9415385</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">0.9473684</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="support-vector-machine-modeling" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine-modeling">Support Vector Machine Modeling</h3>
<p>SVM is used to predict the RESULT of the tennis matches on this project. As a cross validation method, k-fold cv is used for k equals 10. This cv is made by using “caret” package in r.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">## SVM tunning process</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>tune_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">C =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>))</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>svm_model <span class="ot">&lt;-</span> <span class="fu">tune.svm</span>(RESULT <span class="sc">~</span> .,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> GrandSlam_trn_std, <span class="at">method =</span> <span class="st">"svmLinear"</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cost =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>),</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cross=</span> <span class="dv">10</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(svm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/SVM-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>best_C <span class="ot">&lt;-</span> svm_model[[<span class="st">"best.parameters"</span>]][[<span class="st">"cost"</span>]]</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>svm_model_tuned <span class="ot">&lt;-</span> <span class="fu">svm</span>(RESULT <span class="sc">~</span> .,</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> GrandSlam_trn_std,</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">"svmLinear"</span>,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cost =</span> best_C, <span class="at">cross=</span> <span class="dv">10</span>)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">t</span>(svm_model_tuned<span class="sc">$</span>coefs) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(svm_model_tuned<span class="sc">$</span>SV)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>order1 <span class="ot">&lt;-</span><span class="fu">order</span>(<span class="fu">abs</span>(coefs[<span class="dv">1</span>,]),<span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(coefs[<span class="dv">1</span>,order1], <span class="at">col.names =</span> <span class="st">"Coefficient"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FSW.2</td>
<td style="text-align: right;">43.0642316</td>
</tr>
<tr class="even">
<td style="text-align: left;">BPC.1</td>
<td style="text-align: right;">-32.4368930</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UFE.2</td>
<td style="text-align: right;">-31.1229632</td>
</tr>
<tr class="even">
<td style="text-align: left;">FSW.1</td>
<td style="text-align: right;">-30.6662176</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BPC.2</td>
<td style="text-align: right;">29.3448395</td>
</tr>
<tr class="even">
<td style="text-align: left;">SSW.2</td>
<td style="text-align: right;">22.1018119</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SSW.1</td>
<td style="text-align: right;">-21.5029159</td>
</tr>
<tr class="even">
<td style="text-align: left;">WNR.1</td>
<td style="text-align: right;">-15.1308059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NPA.1</td>
<td style="text-align: right;">14.7136968</td>
</tr>
<tr class="even">
<td style="text-align: left;">ACE.2</td>
<td style="text-align: right;">10.6946186</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACE.1</td>
<td style="text-align: right;">-10.0169895</td>
</tr>
<tr class="even">
<td style="text-align: left;">UFE.1</td>
<td style="text-align: right;">9.5466106</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DBF.1</td>
<td style="text-align: right;">8.6903488</td>
</tr>
<tr class="even">
<td style="text-align: left;">WNR.2</td>
<td style="text-align: right;">7.5866203</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FSP.2</td>
<td style="text-align: right;">7.1859839</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENDERM</td>
<td style="text-align: right;">-5.3058548</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FSP.1</td>
<td style="text-align: right;">-4.5042179</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROUND5</td>
<td style="text-align: right;">4.0769710</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ROUND4</td>
<td style="text-align: right;">-3.6190015</td>
</tr>
<tr class="even">
<td style="text-align: left;">TOURNAMENTFrenchOpen</td>
<td style="text-align: right;">-3.5424787</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOURNAMENTUSopen</td>
<td style="text-align: right;">2.7900080</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROUND2</td>
<td style="text-align: right;">-2.6657715</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOURNAMENTWimbledon</td>
<td style="text-align: right;">2.6474686</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROUND6</td>
<td style="text-align: right;">-2.0539856</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ROUND3</td>
<td style="text-align: right;">1.8817189</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROUND1</td>
<td style="text-align: right;">1.7613557</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DBF.2</td>
<td style="text-align: right;">-1.6099715</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROUND7</td>
<td style="text-align: right;">0.6187128</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NPA.2</td>
<td style="text-align: right;">-0.3466687</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the final predictions from the cross-validation</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>Train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_model_tuned, <span class="at">newdata =</span> GrandSlam_trn_std)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>Test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_model_tuned, <span class="at">newdata =</span> GrandSlam_tst_std)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create confusion matrix</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(Test_pred, GrandSlam_tst_std<span class="sc">$</span>RESULT)</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>conf_matrix_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(conf_matrix_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>, <span class="st">"Frequency"</span>)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(conf_matrix_df, <span class="fu">aes</span>(Prediction,Reference, <span class="at">fill=</span> Frequency)) <span class="sc">+</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Frequency)) <span class="sc">+</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"white"</span>, <span class="at">high=</span><span class="st">"#009194"</span>) <span class="sc">+</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Reference"</span>,<span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"RESULT 1"</span>, <span class="st">"RESULT 2"</span>)) <span class="sc">+</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"RESULT 1"</span>, <span class="st">"RESULT 2"</span>))<span class="sc">+</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="st">"Test Data Confusion Matrix of SVM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/SVM-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract performance metrics</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>overall[<span class="st">'Accuracy'</span>]</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">'Pos Pred Value'</span>]</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">'Sensitivity'</span>]</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a performance table</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>performance_table_svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span>, <span class="st">"Precision"</span>, <span class="st">"Recall"</span>, <span class="st">"F1-Score"</span>),</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(accuracy, precision, recall, f1_score))</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(performance_table_svm,  <span class="at">caption =</span> <span class="st">"Test data Performance of SVM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Test data Performance of SVM</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.9386503</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">0.9382716</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">0.9382716</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">0.9382716</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Training performance</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>conf_matrix2 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(Train_pred, GrandSlam_trn_std<span class="sc">$</span>RESULT)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract performance metrics</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>accuracy2 <span class="ot">&lt;-</span> conf_matrix2<span class="sc">$</span>overall[<span class="st">'Accuracy'</span>]</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>precision2 <span class="ot">&lt;-</span> conf_matrix2<span class="sc">$</span>byClass[<span class="st">'Pos Pred Value'</span>]</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>recall2 <span class="ot">&lt;-</span> conf_matrix2<span class="sc">$</span>byClass[<span class="st">'Sensitivity'</span>]</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>f1_score2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision2 <span class="sc">*</span> recall2) <span class="sc">/</span> (precision2 <span class="sc">+</span> recall2)</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a performance table</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>performance_table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span>, <span class="st">"Precision"</span>, <span class="st">"Recall"</span>, <span class="st">"F1-Score"</span>),</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(accuracy2, precision2, recall2, f1_score2))</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(performance_table2,  <span class="at">caption =</span> <span class="st">"Train data Performance of SVM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Train data Performance of SVM</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.9800919</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">0.9814815</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">0.9784615</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">0.9799692</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Cost parameter tuned as5 after 10 k fold cv. SVM has a 0.9386503 accuracy for test data. Coefficients table shows that BPC and FSW are the most effective statistics to predict match. Also, WNR, SSW and UFE are effective statistics too. Important statistics are like logistic regression.</p>
</section>
<section id="random-forest-model" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-model">Random Forest Model</h3>
<p>Random forest model mtree parameter is tuned with 10 k fold cross validation for 2 to 28 grid. 1000 number of tree used for modeling to reach minimum error.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model using random forest with tuning</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">train</span>(RESULT <span class="sc">~</span> ., <span class="at">data =</span> GrandSlam_trn_std, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">trControl =</span> train_control, <span class="at">tuneLength =</span> <span class="dv">28</span>,<span class="at">ntree=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>note: only 27 unique complexity parameters in default grid. Truncating the grid to 27 .</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>best_mtree <span class="ot">&lt;-</span> rf_model[[<span class="st">"bestTune"</span>]][[<span class="st">"mtry"</span>]]</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rf_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/random_f-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rf_model[[<span class="st">"finalModel"</span>]][[<span class="st">"err.rate"</span>]][,<span class="st">"OOB"</span>],<span class="at">main =</span> <span class="st">"Random Forest Model"</span>,<span class="at">xlab =</span> <span class="st">"#Tree"</span>, <span class="at">ylab =</span> <span class="st">"OOB Error"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/random_f-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>After tuning process, mtree tuned as 3 considering accuracy. Also, OOB error stabilize after 600-700 trees. Therefore 1000 tree is acceptable for modeling.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>Train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> GrandSlam_trn_std)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>Test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> GrandSlam_tst_std)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create confusion matrix</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(Test_pred, GrandSlam_tst_std<span class="sc">$</span>RESULT)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>conf_matrix_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(conf_matrix_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>, <span class="st">"Frequency"</span>)</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(conf_matrix_df, <span class="fu">aes</span>(Prediction,Reference, <span class="at">fill=</span> Frequency)) <span class="sc">+</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Frequency)) <span class="sc">+</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"white"</span>, <span class="at">high=</span><span class="st">"#009194"</span>) <span class="sc">+</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Reference"</span>,<span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"RESULT 1"</span>, <span class="st">"RESULT 2"</span>)) <span class="sc">+</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"RESULT 1"</span>, <span class="st">"RESULT 2"</span>))<span class="sc">+</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="st">"Test Data Confusion Matrix of Random Forest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/rf_conf-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract performance metrics</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>overall[<span class="st">'Accuracy'</span>]</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">'Pos Pred Value'</span>]</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">'Sensitivity'</span>]</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a performance table</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>performance_table_rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span>, <span class="st">"Precision"</span>, <span class="st">"Recall"</span>, <span class="st">"F1-Score"</span>),</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(accuracy, precision, recall, f1_score))</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(performance_table_rf,  <span class="at">caption =</span> <span class="st">"Test data Performance of Random Forest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Test data Performance of Random Forest</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.9325153</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">0.9487179</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">0.9135802</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">0.9308176</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Accuracy of test data is 0.9325153. Model performed better than svm and logistic regression.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Training performance</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>conf_matrix2 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(Train_pred, GrandSlam_trn_std<span class="sc">$</span>RESULT)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract performance metrics</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>accuracy2 <span class="ot">&lt;-</span> conf_matrix2<span class="sc">$</span>overall[<span class="st">'Accuracy'</span>]</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>precision2 <span class="ot">&lt;-</span> conf_matrix2<span class="sc">$</span>byClass[<span class="st">'Pos Pred Value'</span>]</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>recall2 <span class="ot">&lt;-</span> conf_matrix2<span class="sc">$</span>byClass[<span class="st">'Sensitivity'</span>]</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>f1_score2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision2 <span class="sc">*</span> recall2) <span class="sc">/</span> (precision2 <span class="sc">+</span> recall2)</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a performance table</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>performance_table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span>, <span class="st">"Precision"</span>, <span class="st">"Recall"</span>, <span class="st">"F1-Score"</span>),</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(accuracy2, precision2, recall2, f1_score2))</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(performance_table2,  <span class="at">caption =</span> <span class="st">"Train data Performance of Random Forest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Train data Performance of Random Forest</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Variable importance table shows that BPC, FSW and WNR are higly important for predicting result. Also UFE, SSW and ACE is seems to effective.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot variable importance</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>var_imp <span class="ot">&lt;-</span> <span class="fu">varImp</span>(rf_model)[[<span class="st">"importance"</span>]]</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>var_rows<span class="ot">&lt;-</span><span class="fu">row.names</span>(var_imp)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>var_rows <span class="ot">&lt;-</span> var_rows[<span class="fu">order</span>(var_imp<span class="sc">$</span>Overall,<span class="at">decreasing =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>var_imp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span>var_rows, <span class="at">Impotance =</span> var_imp[<span class="fu">order</span>(var_imp<span class="sc">$</span>Overall,<span class="at">decreasing =</span> <span class="cn">TRUE</span>),])</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(var_imp_df,<span class="at">caption =</span> <span class="st">"Variable Importance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Variable Importance</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Impotance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BPC.1</td>
<td style="text-align: right;">100.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">BPC.2</td>
<td style="text-align: right;">63.7355289</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FSW.1</td>
<td style="text-align: right;">61.1481683</td>
</tr>
<tr class="even">
<td style="text-align: left;">FSW.2</td>
<td style="text-align: right;">53.9957659</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WNR.1</td>
<td style="text-align: right;">39.7010570</td>
</tr>
<tr class="even">
<td style="text-align: left;">WNR.2</td>
<td style="text-align: right;">39.6480812</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UFE.1</td>
<td style="text-align: right;">29.8562826</td>
</tr>
<tr class="even">
<td style="text-align: left;">SSW.1</td>
<td style="text-align: right;">28.3994231</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SSW.2</td>
<td style="text-align: right;">28.2838309</td>
</tr>
<tr class="even">
<td style="text-align: left;">UFE.2</td>
<td style="text-align: right;">27.4204335</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACE.2</td>
<td style="text-align: right;">24.9224502</td>
</tr>
<tr class="even">
<td style="text-align: left;">ACE.1</td>
<td style="text-align: right;">23.5576818</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DBF.2</td>
<td style="text-align: right;">18.2223057</td>
</tr>
<tr class="even">
<td style="text-align: left;">FSP.1</td>
<td style="text-align: right;">17.1787634</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NPA.2</td>
<td style="text-align: right;">16.5633377</td>
</tr>
<tr class="even">
<td style="text-align: left;">DBF.1</td>
<td style="text-align: right;">16.2515244</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NPA.1</td>
<td style="text-align: right;">15.7756956</td>
</tr>
<tr class="even">
<td style="text-align: left;">FSP.2</td>
<td style="text-align: right;">15.2929351</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENDERM</td>
<td style="text-align: right;">3.6716320</td>
</tr>
<tr class="even">
<td style="text-align: left;">TOURNAMENTFrenchOpen</td>
<td style="text-align: right;">2.6747552</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ROUND2</td>
<td style="text-align: right;">2.6396837</td>
</tr>
<tr class="even">
<td style="text-align: left;">TOURNAMENTWimbledon</td>
<td style="text-align: right;">2.4120395</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ROUND3</td>
<td style="text-align: right;">2.1320431</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROUND4</td>
<td style="text-align: right;">1.4371851</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOURNAMENTUSopen</td>
<td style="text-align: right;">1.2683174</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROUND5</td>
<td style="text-align: right;">0.8524930</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ROUND6</td>
<td style="text-align: right;">0.0910756</td>
</tr>
<tr class="even">
<td style="text-align: left;">ROUND7</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="artificial-neural-network-model" class="level3">
<h3 class="anchored" data-anchor-id="artificial-neural-network-model">Artificial Neural Network Model</h3>
<p>Neura network with one hidden layer that has 1 node is used to predict Result. There is one hidden layer with one node because, we want to make more interpretable model.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>GrandSlam_trn_std_nn <span class="ot">&lt;-</span> GrandSlam_trn_std</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>GrandSlam_tst_std_nn <span class="ot">&lt;-</span> GrandSlam_tst_std</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>GrandSlam_trn_std_nn<span class="sc">$</span>ROUND <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(GrandSlam_trn_std_nn<span class="sc">$</span>ROUND)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>GrandSlam_trn_std_nn<span class="sc">$</span>TOURNAMENT <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(GrandSlam_trn_std_nn<span class="sc">$</span>TOURNAMENT)</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>GrandSlam_trn_std_nn<span class="sc">$</span>GENDER <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(GrandSlam_trn_std_nn<span class="sc">$</span>GENDER)</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>GrandSlam_tst_std_nn<span class="sc">$</span>ROUND <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(GrandSlam_tst_std_nn<span class="sc">$</span>ROUND)</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>GrandSlam_tst_std_nn<span class="sc">$</span>TOURNAMENT <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(GrandSlam_tst_std_nn<span class="sc">$</span>TOURNAMENT)</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>GrandSlam_tst_std_nn<span class="sc">$</span>GENDER <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(GrandSlam_tst_std_nn<span class="sc">$</span>GENDER)</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a grid for tuning the learning rate (decay parameter)</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>tune_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">size =</span> <span class="dv">1</span>,  <span class="co"># Number of units in the hidden layer, adjust if necessary</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">decay =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>))  <span class="co"># Learning rate values to tune</span></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model using neural network with tuning and cross-validation</span></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>nn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(RESULT <span class="sc">~</span> ., <span class="at">data =</span> GrandSlam_trn_std_nn, <span class="at">method =</span> <span class="st">"nnet"</span>,</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> train_control,</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tuneGrid =</span> tune_grid,</span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linout =</span> <span class="cn">FALSE</span>,  <span class="co"># For classification problems</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>)  <span class="co"># Do not print the training process</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>best_lr <span class="ot">&lt;-</span> nn_model<span class="sc">$</span>bestTune<span class="sc">$</span>decay</span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a>best_size <span class="ot">&lt;-</span> nn_model<span class="sc">$</span>bestTune<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Learning rate tuned as 0.01 by 10 k fold cross validation. With this learning rate neural network model formed.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nn_model,<span class="at">main=</span><span class="st">"Cross-validation of Neural Network by learning rate"</span>, <span class="at">xlab=</span><span class="st">"Learning Rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/nn_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>nn_tuned <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(RESULT<span class="sc">~</span>.,<span class="at">data=</span>GrandSlam_trn_std_nn,<span class="at">linear.output =</span> <span class="cn">FALSE</span>,<span class="at">act.fct =</span> <span class="st">"logistic"</span>,<span class="at">hidden =</span> <span class="dv">1</span>,<span class="at">learningrate =</span> best_lr)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>Train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(nn_tuned, <span class="at">newdata =</span> GrandSlam_trn_std_nn)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>Train_pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Train_pred[,<span class="dv">1</span>]<span class="sc">&lt;</span><span class="fl">0.4</span>, <span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>Test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(nn_tuned, <span class="at">newdata =</span> GrandSlam_tst_std_nn)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>Test_pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Test_pred[,<span class="dv">1</span>]<span class="sc">&lt;</span><span class="fl">0.4</span>, <span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">actual =</span> GrandSlam_tst_std_nn<span class="sc">$</span>RESULT, <span class="at">prediction =</span> Test_pred)</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>actual <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(results<span class="sc">$</span>actual)</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>prediction <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(results<span class="sc">$</span>prediction)</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create confusion matrix</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(results<span class="sc">$</span>prediction, results<span class="sc">$</span>actual)</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>conf_matrix_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(conf_matrix<span class="sc">$</span>table)</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(conf_matrix_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>, <span class="st">"Frequency"</span>)</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(conf_matrix_df, <span class="fu">aes</span>(Prediction,Reference, <span class="at">fill=</span> Frequency)) <span class="sc">+</span></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Frequency)) <span class="sc">+</span></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"white"</span>, <span class="at">high=</span><span class="st">"#009194"</span>) <span class="sc">+</span></span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Reference"</span>,<span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"RESULT 1"</span>, <span class="st">"RESULT 2"</span>)) <span class="sc">+</span></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"RESULT 1"</span>, <span class="st">"RESULT 2"</span>))<span class="sc">+</span></span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="st">"Test Data Confusion Matrix of Neural Network"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/nn_tuned-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract performance metrics</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>overall[<span class="st">'Accuracy'</span>]</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">'Pos Pred Value'</span>]</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> conf_matrix<span class="sc">$</span>byClass[<span class="st">'Sensitivity'</span>]</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a performance table</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>performance_table_nn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span>, <span class="st">"Precision"</span>, <span class="st">"Recall"</span>, <span class="st">"F1-Score"</span>),</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(accuracy, precision, recall, f1_score))</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(performance_table_nn,  <span class="at">caption =</span> <span class="st">"Test data Performance of Neural Network"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Test data Performance of Neural Network</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.9325153</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">0.9487179</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">0.9135802</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">0.9308176</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Accuracy of test data is 0.9325153. Also this accuracy is very close to the train data performance.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>results_trn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">actual =</span> GrandSlam_trn_std_nn<span class="sc">$</span>RESULT, <span class="at">prediction =</span> Train_pred)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>results_trn<span class="sc">$</span>actual <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(results_trn<span class="sc">$</span>actual)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>results_trn<span class="sc">$</span>prediction <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(results_trn<span class="sc">$</span>prediction)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Training performance</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>conf_matrix2 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(results_trn<span class="sc">$</span>prediction, results_trn<span class="sc">$</span>actual)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract performance metrics</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>accuracy2 <span class="ot">&lt;-</span> conf_matrix2<span class="sc">$</span>overall[<span class="st">'Accuracy'</span>]</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>precision2 <span class="ot">&lt;-</span> conf_matrix2<span class="sc">$</span>byClass[<span class="st">'Pos Pred Value'</span>]</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>recall2 <span class="ot">&lt;-</span> conf_matrix2<span class="sc">$</span>byClass[<span class="st">'Sensitivity'</span>]</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>f1_score2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision2 <span class="sc">*</span> recall2) <span class="sc">/</span> (precision2 <span class="sc">+</span> recall2)</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a performance table</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>performance_table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span>, <span class="st">"Precision"</span>, <span class="st">"Recall"</span>, <span class="st">"F1-Score"</span>),</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(accuracy2, precision2, recall2, f1_score2))</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(performance_table2,  <span class="at">caption =</span> <span class="st">"Train data Performance of Neural Network"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Train data Performance of Neural Network</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.9693721</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">0.9841270</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">0.9538462</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">0.9687500</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Weight table shows that FSW, BPC and SSW are the most effective variables to predict result.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>weight_nn <span class="ot">&lt;-</span> nn_tuned<span class="sc">$</span>weights[[<span class="dv">1</span>]][[<span class="dv">1</span>]]</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Feature =</span> <span class="fu">colnames</span>(GrandSlam_trn_std)[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(GrandSlam_trn_std) <span class="sc">==</span> <span class="st">"RESULT"</span>)], <span class="at">Weights =</span> weight_nn[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(feature_importance[<span class="fu">order</span>(<span class="fu">abs</span>(feature_importance<span class="sc">$</span>Weights),<span class="at">decreasing =</span> <span class="cn">TRUE</span>),],<span class="at">caption =</span> <span class="st">"Feature Importance Table"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Feature Importance Table</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Feature</th>
<th style="text-align: right;">Weights</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">FSW.2</td>
<td style="text-align: right;">4.9722534</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">BPC.1</td>
<td style="text-align: right;">-4.8126220</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">FSW.1</td>
<td style="text-align: right;">-4.7288765</td>
</tr>
<tr class="even">
<td style="text-align: left;">17</td>
<td style="text-align: left;">BPC.2</td>
<td style="text-align: right;">3.6251014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: left;">SSW.2</td>
<td style="text-align: right;">3.1420426</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">SSW.1</td>
<td style="text-align: right;">-1.9390834</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">UFE.1</td>
<td style="text-align: right;">1.7265605</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">WNR.1</td>
<td style="text-align: right;">-1.0634183</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20</td>
<td style="text-align: left;">TOURNAMENT</td>
<td style="text-align: right;">0.6128002</td>
</tr>
<tr class="even">
<td style="text-align: left;">14</td>
<td style="text-align: left;">DBF.2</td>
<td style="text-align: right;">-0.6042338</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18</td>
<td style="text-align: left;">NPA.2</td>
<td style="text-align: right;">0.5930887</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: left;">NPA.1</td>
<td style="text-align: right;">-0.5445063</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: left;">WNR.2</td>
<td style="text-align: right;">-0.5320031</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">FSP.2</td>
<td style="text-align: right;">0.3342510</td>
</tr>
<tr class="odd">
<td style="text-align: left;">19</td>
<td style="text-align: left;">ROUND</td>
<td style="text-align: right;">-0.2707809</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">ACE.1</td>
<td style="text-align: right;">-0.1985878</td>
</tr>
<tr class="odd">
<td style="text-align: left;">16</td>
<td style="text-align: left;">UFE.2</td>
<td style="text-align: right;">-0.1194902</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">DBF.1</td>
<td style="text-align: right;">0.0759662</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: left;">ACE.2</td>
<td style="text-align: right;">0.0621077</td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: left;">GENDER</td>
<td style="text-align: right;">0.0555643</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">FSP.1</td>
<td style="text-align: right;">-0.0489959</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results of the tuning</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">plot</span>(nn_tuned,<span class="at">rep =</span> <span class="st">"best"</span>,<span class="at">main=</span><span class="st">"Neural Nework Plot"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/plot_nn-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">

</div>
</div>
</section>
<section id="model-comparison-table" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison-table">Model Comparison Table</h3>
<p>Model comparison table show that ANN has the best accuracy. Also when we consider importance of variable, all of the model indicate that FSW, BPC, SSW are the most effective statistics that effect the result. UFE and WNR are the effective too for all models.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>comp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Metric"</span><span class="ot">=</span> performance_table_log<span class="sc">$</span>Metric,</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Logistic Reg"</span> <span class="ot">=</span> performance_table_log<span class="sc">$</span>Value,</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"SVM"</span><span class="ot">=</span>performance_table_svm<span class="sc">$</span>Value,</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Random Forest"</span><span class="ot">=</span>performance_table_rf<span class="sc">$</span>Value,</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"ANN"</span> <span class="ot">=</span> performance_table_nn<span class="sc">$</span>Value) </span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comp_df, <span class="at">caption =</span> <span class="st">"Performance Comporison"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Performance Comporison</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Logistic.Reg</th>
<th style="text-align: right;">SVM</th>
<th style="text-align: right;">Random.Forest</th>
<th style="text-align: right;">ANN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.9263804</td>
<td style="text-align: right;">0.9386503</td>
<td style="text-align: right;">0.9325153</td>
<td style="text-align: right;">0.9325153</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision</td>
<td style="text-align: right;">0.9259259</td>
<td style="text-align: right;">0.9382716</td>
<td style="text-align: right;">0.9487179</td>
<td style="text-align: right;">0.9487179</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recall</td>
<td style="text-align: right;">0.9259259</td>
<td style="text-align: right;">0.9382716</td>
<td style="text-align: right;">0.9135802</td>
<td style="text-align: right;">0.9135802</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1-Score</td>
<td style="text-align: right;">0.9259259</td>
<td style="text-align: right;">0.9382716</td>
<td style="text-align: right;">0.9308176</td>
<td style="text-align: right;">0.9308176</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="regression-modelling-for-tpw" class="level2">
<h2 class="anchored" data-anchor-id="regression-modelling-for-tpw">Regression Modelling for TPW</h2>
<p>In regression part, we seperate the player statistics and create new data set like below. Tournament, round and gender parameters are removed because their effect on result is not much according to classification modeling results. Also, Result colun removed because our aim is find most effective player statistics to create more points in regression part.</p>
<section id="train-test-data-set-preparation-1" class="level3">
<h3 class="anchored" data-anchor-id="train-test-data-set-preparation-1">Train-Test Data Set Preparation</h3>
<p>GrandSlam data set splited by 20% test and 80% training by random selection by considering TPW distribution. Before modelling, numeric variables in the train and test data set should be scaled. Firstly, train set is scaled and then, by using train set mean and standart deviation test set should be scaled too. Test and train sets are scaled after splitting, because, test observations should not be effect anything on the train data set in order to maintain integrity of model evaluation. After scale the train data set summary is like below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(GrandSlam_Reg_final<span class="sc">$</span>TPW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  GrandSlam_Reg_final$TPW
W = 0.98635, p-value = 4.395e-08</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(GrandSlam_Reg_final,<span class="fu">aes</span>(<span class="at">x=</span>TPW))<span class="sc">+</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/train_test_reg-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>lmbd <span class="ot">&lt;-</span><span class="fu">BoxCoxTrans</span>(GrandSlam_Reg_final<span class="sc">$</span>TPW)<span class="sc">$</span>lambda</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>boxcox_transform <span class="ot">&lt;-</span> <span class="cf">function</span>(y, lambda) {</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(lambda <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">log</span>(y))</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>((y<span class="sc">^</span>lambda <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> lambda)</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>GrandSlam_Reg_final<span class="sc">$</span>TPW <span class="ot">&lt;-</span> <span class="fu">boxcox_transform</span>(GrandSlam_Reg_final<span class="sc">$</span>TPW, lmbd)</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"After Box Cox Transformation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "After Box Cox Transformation"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(GrandSlam_Reg_final,<span class="fu">aes</span>(<span class="at">x=</span>TPW))<span class="sc">+</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/train_test_reg-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creating test training data by considcering distribution of Result</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>GrandSlam_idx <span class="ot">=</span> <span class="fu">createDataPartition</span>(GrandSlam_Reg_final<span class="sc">$</span>TPW, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>GrandSlam_train <span class="ot">=</span> GrandSlam_Reg_final[GrandSlam_idx, ]</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>GrandSlam_test <span class="ot">=</span> GrandSlam_Reg_final[<span class="sc">-</span>GrandSlam_idx, ]</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>train_numeric <span class="ot">&lt;-</span> GrandSlam_train <span class="sc">%&gt;%</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric)</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>test_numeric <span class="ot">&lt;-</span> GrandSlam_test <span class="sc">%&gt;%</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric)</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the training predictors</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>train_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(train_numeric, <span class="dv">2</span>, mean)</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>train_sd <span class="ot">&lt;-</span> <span class="fu">apply</span>(train_numeric, <span class="dv">2</span>, sd)</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>train_numeric_standardized <span class="ot">&lt;-</span> <span class="fu">scale</span>(train_numeric, <span class="at">center =</span> train_mean, <span class="at">scale =</span> train_sd)</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the test predictors using training mean and sd</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>test_numeric_standardized <span class="ot">&lt;-</span> <span class="fu">scale</span>(test_numeric, <span class="at">center =</span> train_mean, <span class="at">scale =</span> train_sd)</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine standardized predictors with the response variable</span></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>GrandSlam_trn_std <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(train_numeric_standardized)</span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>GrandSlam_tst_std <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(test_numeric_standardized)</span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GrandSlam_trn_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      FSP                FSW               SSW                 ACE         
 Min.   :-2.76221   Min.   :-2.8491   Min.   :-2.598475   Min.   :-1.2004  
 1st Qu.:-0.67629   1st Qu.:-0.6594   1st Qu.:-0.675072   1st Qu.:-0.7789  
 Median : 0.05991   Median :-0.0145   Median : 0.002383   Median :-0.1824  
 Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.000000   Mean   : 0.0000  
 3rd Qu.: 0.67341   3rd Qu.: 0.6056   3rd Qu.: 0.612862   3rd Qu.: 0.4856  
 Max.   : 3.49553   Max.   : 4.8884   Max.   : 4.360265   Max.   : 5.2297  
      DBF               WNR                 UFE               BPC         
 Min.   :-1.3280   Min.   :-2.175997   Min.   :-0.8330   Min.   :-1.6845  
 1st Qu.:-0.7178   1st Qu.:-0.643035   1st Qu.:-0.7755   1st Qu.:-0.7520  
 Median :-0.1747   Median :-0.003407   Median :-0.7269   Median :-0.1304  
 Mean   : 0.0000   Mean   : 0.000000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.: 0.4907   3rd Qu.: 0.602202   3rd Qu.: 0.7586   3rd Qu.: 0.6108  
 Max.   : 4.7913   Max.   : 4.717799   Max.   : 4.2600   Max.   : 4.6150  
      NPA               TPW          
 Min.   :-2.0207   Min.   :-4.11851  
 1st Qu.:-0.7592   1st Qu.:-0.65444  
 Median :-0.1203   Median : 0.06319  
 Mean   : 0.0000   Mean   : 0.00000  
 3rd Qu.: 0.6048   3rd Qu.: 0.64280  
 Max.   : 4.1266   Max.   : 4.88081  </code></pre>
</div>
</div>
</section>
<section id="linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression">Linear Regression</h3>
<p>As seen on the correlation plot, there is multicollinearity between FSP and SSW. FSP column removed from dataset because of multicollinearity. Also There are strong positive relationship between TPW and FSW, BPC. TPW has slightly positive relationship between SSW and WNR. ACE, DBF, UFE and NPA are not correlate with TPW.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(GrandSlam_trn_std,<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Print correlation matrix</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/corr_reg-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>GrandSlam_trn_std <span class="ot">&lt;-</span> GrandSlam_trn_std <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FSP)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>GrandSlam_tst_std <span class="ot">&lt;-</span> GrandSlam_tst_std <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FSP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">train</span>(TPW<span class="sc">~</span>., <span class="at">data =</span> GrandSlam_trn_std, </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trControl =</span> train_control)</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linear_model<span class="sc">$</span>finalModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.25470 -0.22417  0.00352  0.22129  1.27163 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -5.321e-16  1.259e-02   0.000   1.0000    
FSW          5.085e-01  1.389e-02  36.621   &lt;2e-16 ***
SSW          3.604e-01  1.326e-02  27.191   &lt;2e-16 ***
ACE         -4.726e-02  1.443e-02  -3.275   0.0011 ** 
DBF          2.498e-02  1.286e-02   1.943   0.0524 .  
WNR          6.358e-02  1.539e-02   4.130    4e-05 ***
UFE         -1.659e-02  1.317e-02  -1.259   0.2083    
BPC          5.954e-01  1.344e-02  44.284   &lt;2e-16 ***
NPA         -3.256e-02  1.316e-02  -2.474   0.0136 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3582 on 800 degrees of freedom
Multiple R-squared:  0.873, Adjusted R-squared:  0.8717 
F-statistic: 687.1 on 8 and 800 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>ACE, DBF, UFE and NPA have small effect on TPW according to parameters. Also UFE is not significant parameter to predict TPW. On the other hand FSW, WNR and BPC has significant and positive effect on TPW. Also, R square is 0.87 that is acceptable.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(linear_model<span class="sc">$</span>finalModel, GrandSlam_tst_std, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>rmse_lm <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(test_pred, GrandSlam_tst_std<span class="sc">$</span>TPW)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>perf_lm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Metric"</span><span class="ot">&lt;-</span> <span class="st">"RMSE"</span>,<span class="st">"Value"</span> <span class="ot">&lt;-</span> rmse_lm)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(perf_lm,<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Values"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: right;">0.3549757</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="lasso-and-ridge-regression" class="level3">
<h3 class="anchored" data-anchor-id="lasso-and-ridge-regression">Lasso and Ridge Regression</h3>
<p>Lasso regression can be used to find most effective parameters. Also ridge can help to find most effective parameters. Both of them used for regression in this part.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">model.matrix</span>(TPW<span class="sc">~</span>.,GrandSlam_trn_std)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span> GrandSlam_trn_std<span class="sc">$</span>TPW</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>x_test<span class="ot">=</span><span class="fu">model.matrix</span>(TPW<span class="sc">~</span>.,GrandSlam_tst_std)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>y_test<span class="ot">=</span> GrandSlam_tst_std<span class="sc">$</span>TPW</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="dv">1</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>lasso.mod<span class="ot">=</span><span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">lambda=</span>grid)</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lasso.mod,<span class="at">main=</span><span class="st">"L1 norm vs Coefficients"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):
collapsing to unique 'x' values</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/lasso_reg-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>cv.out<span class="ot">=</span><span class="fu">cv.glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/lasso_reg-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>low_predictor_lam<span class="ot">=</span>cv.out<span class="sc">$</span>lambda<span class="fl">.1</span>se</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>bestlam<span class="ot">=</span>cv.out<span class="sc">$</span>lambda.min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Grid search for lambda shows that FSW, WNR and BPC are. the most effective parameters to win more points. Also, 10 fold cross validation applied to find best lambda value by considering RMSE, best lambda for lasso is 0.0018243. For best lambda value, lasso regression use all of the variable. Coefficients of lasso regression are like below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>lasso.pred<span class="ot">=</span><span class="fu">predict</span>(lasso.mod,<span class="at">s=</span>bestlam ,<span class="at">newx=</span>x_test)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>RMSE_lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>((lasso.pred<span class="sc">-</span>y_test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">lambda=</span>grid)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>lasso.coef<span class="ot">=</span><span class="fu">predict</span>(out,<span class="at">type=</span><span class="st">"coefficients"</span>,<span class="at">s=</span>bestlam)[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,]</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>lasso.coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)           FSW           SSW           ACE           DBF 
-4.234144e-16  5.009422e-01  3.549125e-01 -3.586303e-02  1.866434e-02 
          WNR           UFE           BPC 
 5.476419e-02 -9.674189e-03  5.949894e-01 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>perf_lasso <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Metric"</span><span class="ot">&lt;-</span> <span class="st">"RMSE"</span>,<span class="st">"Value"</span> <span class="ot">&lt;-</span> RMSE_lasso)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(perf_lasso,<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Values"</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: right;">0.1251724</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Ridge regression can be used to find effective parameters and predict TPW for players.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">model.matrix</span>(TPW<span class="sc">~</span>.,GrandSlam_trn_std)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span> GrandSlam_trn_std<span class="sc">$</span>TPW</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>x_test<span class="ot">=</span><span class="fu">model.matrix</span>(TPW<span class="sc">~</span>.,GrandSlam_tst_std)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>y_test<span class="ot">=</span> GrandSlam_tst_std<span class="sc">$</span>TPW</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="dv">1</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>ridge.mod<span class="ot">=</span><span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">0</span>,<span class="at">lambda=</span>grid)</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridge.mod,<span class="at">main=</span><span class="st">"L1 norm vs Coefficients"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/ridge_reg-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>cv.out<span class="ot">=</span><span class="fu">cv.glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">0</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tennis_DA_quarto_files/figure-html/ridge_reg-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>bestlam<span class="ot">=</span>cv.out<span class="sc">$</span>lambda.min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lambda tuned as 0.0703011.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>ridge.pred<span class="ot">=</span><span class="fu">predict</span>(ridge.mod,<span class="at">s=</span>bestlam ,<span class="at">newx=</span>x_test)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>RMSE_ridge <span class="ot">&lt;-</span> <span class="fu">mean</span>((ridge.pred<span class="sc">-</span>y_test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">0</span>,<span class="at">lambda=</span>grid)</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>ridge.coef<span class="ot">=</span><span class="fu">predict</span>(out,<span class="at">type=</span><span class="st">"coefficients"</span>,<span class="at">s=</span>bestlam)[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,]</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>ridge.coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)           FSW           SSW           ACE           DBF 
-4.160499e-16  4.703406e-01  3.323561e-01 -3.435496e-02  2.219150e-02 
          WNR           UFE           BPC 
 7.974837e-02 -2.162348e-02  5.587812e-01 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>perf_ridge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Metric"</span><span class="ot">&lt;-</span> <span class="st">"RMSE"</span>,<span class="st">"Value"</span> <span class="ot">&lt;-</span> RMSE_ridge)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(perf_ridge,<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Values"</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: right;">0.132524</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>